<!DOCTYPE html><html lang="en" dir="ltr" data-theme="dark" data-has-toc data-has-sidebar class="astro-bguv2lll"> <head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Match 3 - Sprite visuals | luxe docs</title><link rel="canonical"/><link rel="shortcut icon" href="/favicon.svg" type="image/svg+xml"/><meta name="generator" content="Astro v5.15.5"/><meta name="generator" content="Starlight v0.36.2"/><meta property="og:title" content="Match 3 - Sprite visuals"/><meta property="og:type" content="article"/><meta property="og:url"/><meta property="og:locale" content="en"/><meta property="og:description" content="A tutorial on making a match 3"/><meta property="og:site_name" content="luxe docs"/><meta name="twitter:card" content="summary_large_image"/><meta name="description" content="A tutorial on making a match 3"/><script>
	window.StarlightThemeProvider = (() => {
		const storedTheme =
			typeof localStorage !== 'undefined' && localStorage.getItem('starlight-theme');
		const theme =
			storedTheme ||
			(window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark');
		document.documentElement.dataset.theme = theme === 'light' ? 'light' : 'dark';
		return {
			updatePickers(theme = storedTheme || 'auto') {
				document.querySelectorAll('starlight-theme-select').forEach((picker) => {
					const select = picker.querySelector('select');
					if (select) select.value = theme;
					/** @type {HTMLTemplateElement | null} */
					const tmpl = document.querySelector(`#theme-icons`);
					const newIcon = tmpl && tmpl.content.querySelector('.' + theme);
					if (newIcon) {
						const oldIcon = picker.querySelector('svg.label-icon');
						if (oldIcon) {
							oldIcon.replaceChildren(...newIcon.cloneNode(true).childNodes);
						}
					}
				});
			},
		};
	})();
</script><template id="theme-icons"><svg aria-hidden="true" class="light astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M5 12a1 1 0 0 0-1-1H3a1 1 0 0 0 0 2h1a1 1 0 0 0 1-1Zm.64 5-.71.71a1 1 0 0 0 0 1.41 1 1 0 0 0 1.41 0l.71-.71A1 1 0 0 0 5.64 17ZM12 5a1 1 0 0 0 1-1V3a1 1 0 0 0-2 0v1a1 1 0 0 0 1 1Zm5.66 2.34a1 1 0 0 0 .7-.29l.71-.71a1 1 0 1 0-1.41-1.41l-.66.71a1 1 0 0 0 0 1.41 1 1 0 0 0 .66.29Zm-12-.29a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.71-.71a1.004 1.004 0 1 0-1.43 1.41l.73.71ZM21 11h-1a1 1 0 0 0 0 2h1a1 1 0 0 0 0-2Zm-2.64 6A1 1 0 0 0 17 18.36l.71.71a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.76-.66ZM12 6.5a5.5 5.5 0 1 0 5.5 5.5A5.51 5.51 0 0 0 12 6.5Zm0 9a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7Zm0 3.5a1 1 0 0 0-1 1v1a1 1 0 0 0 2 0v-1a1 1 0 0 0-1-1Z"/></svg><svg aria-hidden="true" class="dark astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.64 13a1 1 0 0 0-1.05-.14 8.049 8.049 0 0 1-3.37.73 8.15 8.15 0 0 1-8.14-8.1 8.59 8.59 0 0 1 .25-2A1 1 0 0 0 8 2.36a10.14 10.14 0 1 0 14 11.69 1 1 0 0 0-.36-1.05Zm-9.5 6.69A8.14 8.14 0 0 1 7.08 5.22v.27a10.15 10.15 0 0 0 10.14 10.14 9.784 9.784 0 0 0 2.1-.22 8.11 8.11 0 0 1-7.18 4.32v-.04Z"/></svg><svg aria-hidden="true" class="auto astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg></template> <script>
  window.StarlightKbdProvider = (() => {
    return {
      updateKbdPickers(type) {
        for (const select of document.querySelectorAll('starlight-kbd-picker select')) {
          const isKnownType = Array.from(select.options).some((option) => option.value === type)
          if (!isKnownType) return
          select.value = type
        }
      },
    }
  })()
</script><link rel="stylesheet" href="/_astro/print.DNXP8c50.css" media="print"><link rel="stylesheet" href="/_astro/index.CQqvigv2.css">
<style>@layer starlight.components{:root{--sl-badge-default-border: var(--sl-color-accent);--sl-badge-default-bg: var(--sl-color-accent-low);--sl-badge-default-text: #fff;--sl-badge-note-border: var(--sl-color-blue);--sl-badge-note-bg: var(--sl-color-blue-low);--sl-badge-note-text: #fff;--sl-badge-danger-border: var(--sl-color-red);--sl-badge-danger-bg: var(--sl-color-red-low);--sl-badge-danger-text: #fff;--sl-badge-success-border: var(--sl-color-green);--sl-badge-success-bg: var(--sl-color-green-low);--sl-badge-success-text: #fff;--sl-badge-caution-border: var(--sl-color-orange);--sl-badge-caution-bg: var(--sl-color-orange-low);--sl-badge-caution-text: #fff;--sl-badge-tip-border: var(--sl-color-purple);--sl-badge-tip-bg: var(--sl-color-purple-low);--sl-badge-tip-text: #fff}[data-theme=light]:root{--sl-badge-default-bg: var(--sl-color-accent-high);--sl-badge-note-bg: var(--sl-color-blue-high);--sl-badge-danger-bg: var(--sl-color-red-high);--sl-badge-success-bg: var(--sl-color-green-high);--sl-badge-caution-bg: var(--sl-color-orange-high);--sl-badge-tip-bg: var(--sl-color-purple-high)}.sl-badge:where(.astro-avdet4wd){display:inline-block;border:1px solid var(--sl-color-border-badge);border-radius:.25rem;font-family:var(--sl-font-system-mono);line-height:normal;color:var(--sl-color-text-badge);background-color:var(--sl-color-bg-badge);overflow-wrap:anywhere}.sidebar-content .sl-badge:where(.astro-avdet4wd){line-height:1;font-size:var(--sl-text-xs);padding:.125rem .375rem}.sidebar-content a[aria-current=page]>.sl-badge:where(.astro-avdet4wd){--sl-color-bg-badge: transparent;--sl-color-border-badge: currentColor;color:inherit}.default:where(.astro-avdet4wd){--sl-color-bg-badge: var(--sl-badge-default-bg);--sl-color-border-badge: var(--sl-badge-default-border);--sl-color-text-badge: var(--sl-badge-default-text)}.note:where(.astro-avdet4wd){--sl-color-bg-badge: var(--sl-badge-note-bg);--sl-color-border-badge: var(--sl-badge-note-border);--sl-color-text-badge: var(--sl-badge-note-text)}.danger:where(.astro-avdet4wd){--sl-color-bg-badge: var(--sl-badge-danger-bg);--sl-color-border-badge: var(--sl-badge-danger-border);--sl-color-text-badge: var(--sl-badge-danger-text)}.success:where(.astro-avdet4wd){--sl-color-bg-badge: var(--sl-badge-success-bg);--sl-color-border-badge: var(--sl-badge-success-border);--sl-color-text-badge: var(--sl-badge-success-text)}.tip:where(.astro-avdet4wd){--sl-color-bg-badge: var(--sl-badge-tip-bg);--sl-color-border-badge: var(--sl-badge-tip-border);--sl-color-text-badge: var(--sl-badge-tip-text)}.caution:where(.astro-avdet4wd){--sl-color-bg-badge: var(--sl-badge-caution-bg);--sl-color-border-badge: var(--sl-badge-caution-border);--sl-color-text-badge: var(--sl-badge-caution-text)}.small:where(.astro-avdet4wd){font-size:var(--sl-text-xs);padding:.125rem .25rem}.medium:where(.astro-avdet4wd){font-size:var(--sl-text-sm);padding:.175rem .35rem}.large:where(.astro-avdet4wd){font-size:var(--sl-text-base);padding:.225rem .45rem}.sl-markdown-content :is(h1,h2,h3,h4,h5,h6) .sl-badge:where(.astro-avdet4wd){vertical-align:middle}}
@layer starlight.components{.card:where(.astro-v5tidmuc){--sl-card-border: var(--sl-color-purple);--sl-card-bg: var(--sl-color-purple-low);border:1px solid var(--sl-color-gray-5);background-color:var(--sl-color-black);padding:clamp(1rem,calc(.125rem + 3vw),2.5rem);flex-direction:column;gap:clamp(.5rem,calc(.125rem + 1vw),1rem)}.card:where(.astro-v5tidmuc):nth-child(4n+1){--sl-card-border: var(--sl-color-orange);--sl-card-bg: var(--sl-color-orange-low)}.card:where(.astro-v5tidmuc):nth-child(4n+3){--sl-card-border: var(--sl-color-green);--sl-card-bg: var(--sl-color-green-low)}.card:where(.astro-v5tidmuc):nth-child(4n+4){--sl-card-border: var(--sl-color-red);--sl-card-bg: var(--sl-color-red-low)}.card:where(.astro-v5tidmuc):nth-child(4n+5){--sl-card-border: var(--sl-color-blue);--sl-card-bg: var(--sl-color-blue-low)}.title:where(.astro-v5tidmuc){font-weight:600;font-size:var(--sl-text-h4);color:var(--sl-color-white);line-height:var(--sl-line-height-headings);gap:1rem;align-items:center}.card:where(.astro-v5tidmuc) .icon:where(.astro-v5tidmuc){border:1px solid var(--sl-card-border);background-color:var(--sl-card-bg);padding:.2em;border-radius:.25rem;flex-shrink:0}.card:where(.astro-v5tidmuc) .body:where(.astro-v5tidmuc){margin:0;font-size:clamp(var(--sl-text-sm),calc(.5rem + 1vw),var(--sl-text-body))}}
@layer starlight.components{svg:where(.astro-c6vsoqas){color:var(--sl-icon-color);font-size:var(--sl-icon-size, 1em);width:1em;height:1em}}
.sl-markdown-content starlight-kbd-picker:where(.astro-k5ijk5yq){display:inline-block}
@layer starlight.components{.sl-link-card:where(.astro-mf7fz2mj){display:grid;grid-template-columns:1fr auto;gap:.5rem;border:1px solid var(--sl-color-gray-5);border-radius:.5rem;padding:1rem;box-shadow:var(--sl-shadow-sm);position:relative}a:where(.astro-mf7fz2mj){text-decoration:none;line-height:var(--sl-line-height-headings)}a:where(.astro-mf7fz2mj):before{content:"";position:absolute;inset:0}.stack:where(.astro-mf7fz2mj){flex-direction:column;gap:.5rem}.title:where(.astro-mf7fz2mj){color:var(--sl-color-white);font-weight:600;font-size:var(--sl-text-lg)}.description:where(.astro-mf7fz2mj){color:var(--sl-color-gray-3);line-height:1.5}.icon:where(.astro-mf7fz2mj){color:var(--sl-color-gray-3)}.sl-link-card:where(.astro-mf7fz2mj):hover{background:var(--sl-color-gray-7, var(--sl-color-gray-6));border-color:var(--sl-color-gray-2)}.sl-link-card:where(.astro-mf7fz2mj):hover .icon:where(.astro-mf7fz2mj){color:var(--sl-color-white)}}
label:where(.astro-e2vmghfl){--sl-label-icon-size: 1rem;--sl-caret-size: 1.25rem;--sl-inline-padding: .5rem;align-items:center;color:var(--sl-color-gray-1);display:inline-flex;gap:.25rem;position:relative}label:where(.astro-e2vmghfl):hover:not(:where(.sl-markdown-content *)){color:var(--sl-color-gray-2)}.sl-markdown-content label:where(.astro-e2vmghfl):hover{color:var(--sl-color-text-accent)}.icon:where(.astro-e2vmghfl){color:var(--sl-icon-color);font-size:var(--sl-icon-size, 1em);height:1em;pointer-events:none;position:absolute;top:50%;transform:translateY(-50%);width:1em}.label-icon:where(.astro-e2vmghfl){font-size:var(--sl-label-icon-size);inset-inline-start:0}.sl-markdown-content .label-icon:where(.astro-e2vmghfl){left:var(--sl-inline-padding)}.caret:where(.astro-e2vmghfl){font-size:var(--sl-caret-size);inset-inline-end:0}.sl-markdown-content .caret:where(.astro-e2vmghfl){right:var(--sl-inline-padding)}select:where(.astro-e2vmghfl){appearance:none;background-color:transparent;border:0;color:inherit;cursor:pointer;padding-block:.25rem;padding-inline:calc(var(--sl-label-icon-size) + var(--sl-inline-padding) + .25rem) calc(var(--sl-caret-size) + var(--sl-inline-padding) + .25rem);text-overflow:ellipsis}.sl-markdown-content select:where(.astro-e2vmghfl){border:1px solid var(--sl-color-white);border-radius:999rem;outline-offset:.1875rem}.sl-markdown-content label:where(.astro-e2vmghfl):hover select:where(.astro-e2vmghfl){border-color:var(--sl-color-text-accent)}option:where(.astro-e2vmghfl){background-color:var(--sl-color-bg-nav);color:var(--sl-color-gray-1)}@media (min-width: 50rem){select:where(.astro-e2vmghfl){font-size:var(--sl-text-sm)}}select:where(.astro-e2vmghfl):not(:where(.sl-markdown-content *)){margin-inline:calc(var(--sl-inline-padding) * -1);padding-block:.625rem}
@layer starlight.components{.sl-steps{--bullet-size: calc(var(--sl-line-height) * 1rem);--bullet-margin: .375rem;list-style:none;counter-reset:steps-counter var(--sl-steps-start, 0);padding-inline-start:0}.sl-steps>li{counter-increment:steps-counter;position:relative;padding-inline-start:calc(var(--bullet-size) + 1rem);padding-bottom:1px;min-height:calc(var(--bullet-size) + var(--bullet-margin))}.sl-steps>li+li{margin-top:0}.sl-steps>li:before{content:counter(steps-counter);position:absolute;top:0;inset-inline-start:0;width:var(--bullet-size);height:var(--bullet-size);line-height:var(--bullet-size);font-size:var(--sl-text-xs);font-weight:600;text-align:center;color:var(--sl-color-white);background-color:var(--sl-color-gray-6);border-radius:99rem;box-shadow:inset 0 0 0 1px var(--sl-color-gray-5)}.sl-steps>li:after{--guide-width: 1px;content:"";position:absolute;top:calc(var(--bullet-size) + var(--bullet-margin));bottom:var(--bullet-margin);inset-inline-start:calc((var(--bullet-size) - var(--guide-width)) / 2);width:var(--guide-width);background-color:var(--sl-color-hairline-light)}}@layer starlight.content{.sl-steps>li>:first-child{--lh: calc(1em * var(--sl-line-height));--shift-y: calc(.5 * (var(--bullet-size) - var(--lh)));transform:translateY(var(--shift-y));margin-bottom:var(--shift-y)}.sl-steps>li>:first-child:where(h1,h2,h3,h4,h5,h6){--lh: calc(1em * var(--sl-line-height-headings))}@supports (--prop: 1lh){.sl-steps>li>:first-child{--lh: 1lh}}}
@layer starlight.components{starlight-file-tree:where(.astro-p67cqifm){--x-space: 1.5rem;--y-space: .125rem;--y-pad: 0;display:block;border:1px solid var(--sl-color-gray-5);padding:1rem;background-color:var(--sl-color-gray-6);font-size:var(--sl-text-xs);font-family:var(--__sl-font-mono);overflow-x:auto}starlight-file-tree:where(.astro-p67cqifm) .directory>details{border:0;padding:0;padding-inline-start:var(--x-space);background:transparent}starlight-file-tree:where(.astro-p67cqifm) .directory>details>summary{margin-inline-start:calc(-1 * var(--x-space));border:0;padding:var(--y-pad) .625rem;font-weight:400;color:var(--sl-color-white);max-width:100%}starlight-file-tree:where(.astro-p67cqifm) .directory>details>summary::marker,starlight-file-tree:where(.astro-p67cqifm) .directory>details>summary::-webkit-details-marker{color:var(--sl-color-gray-3)}starlight-file-tree:where(.astro-p67cqifm) .directory>details>summary:hover,starlight-file-tree:where(.astro-p67cqifm) .directory>details>summary:hover .tree-icon{cursor:pointer;color:var(--sl-color-text-accent);fill:currentColor}starlight-file-tree:where(.astro-p67cqifm) .directory>details>summary:hover~ul{border-color:var(--sl-color-gray-4)}starlight-file-tree:where(.astro-p67cqifm) .directory>details>summary:hover .highlight .tree-icon{color:var(--sl-color-text-invert);fill:currentColor}starlight-file-tree:where(.astro-p67cqifm) ul{margin-inline-start:.5rem;border-inline-start:1px solid var(--sl-color-gray-5);padding:0;padding-inline-start:.125rem;list-style:none}starlight-file-tree:where(.astro-p67cqifm)>ul{margin:0;border:0;padding:0}starlight-file-tree:where(.astro-p67cqifm) li{margin:var(--y-space) 0;padding:var(--y-pad) 0}starlight-file-tree:where(.astro-p67cqifm) .file{margin-inline-start:calc(var(--x-space) - .125rem);color:var(--sl-color-white)}starlight-file-tree:where(.astro-p67cqifm) .tree-entry{display:inline-flex;align-items:flex-start;flex-wrap:wrap;max-width:calc(100% - 1rem)}@media (min-width: 30em){starlight-file-tree:where(.astro-p67cqifm) .tree-entry{flex-wrap:nowrap}}starlight-file-tree:where(.astro-p67cqifm) .tree-entry>:first-child{flex-shrink:0}starlight-file-tree:where(.astro-p67cqifm) .empty{color:var(--sl-color-gray-3);padding-inline-start:.375rem}starlight-file-tree:where(.astro-p67cqifm) .comment{color:var(--sl-color-gray-3);padding-inline-start:1.625rem;max-width:24rem;min-width:12rem}starlight-file-tree:where(.astro-p67cqifm) .highlight{display:inline-block;border-radius:.25rem;padding-inline-end:.5rem;color:var(--sl-color-text-invert);background-color:var(--sl-color-text-accent)}starlight-file-tree:where(.astro-p67cqifm) svg{display:inline;fill:var(--sl-color-gray-3);vertical-align:middle;margin-inline:.25rem .375rem;width:.875rem;height:.875rem}starlight-file-tree:where(.astro-p67cqifm) .highlight svg.tree-icon{fill:currentColor}}
@layer starlight.components{.sl-link-button:where(.astro-xwgiixxa){align-items:center;border:1px solid transparent;border-radius:999rem;display:inline-flex;font-size:var(--sl-text-sm);gap:.5em;line-height:1.1875;outline-offset:.25rem;padding:.4375rem 1.125rem;text-decoration:none}.sl-link-button:where(.astro-xwgiixxa).primary{background:var(--sl-color-text-accent);border-color:var(--sl-color-text-accent);color:var(--sl-color-black)}.sl-link-button:where(.astro-xwgiixxa).primary:hover{color:var(--sl-color-black)}.sl-link-button:where(.astro-xwgiixxa).secondary{border-color:inherit;color:var(--sl-color-white)}.sl-link-button:where(.astro-xwgiixxa).minimal{color:var(--sl-color-white);padding-inline:0}.sl-link-button:where(.astro-xwgiixxa) svg{flex-shrink:0}@media (min-width: 50rem){.sl-link-button:where(.astro-xwgiixxa){font-size:var(--sl-text-base);padding:.9375rem 1.25rem}}.sl-markdown-content .sl-link-button:where(.astro-xwgiixxa){margin-inline-end:1rem}.sl-markdown-content .sl-link-button:where(.astro-xwgiixxa):not(:where(p *)){margin-block:1rem}}
</style><script type="module" src="/_astro/page.B1D-nYk3.js"></script></head> <body class="astro-bguv2lll"> <a href="#_top" class="astro-7q3lir66">Skip to content</a>  <div class="page sl-flex astro-vrdttmbt"> <header class="header astro-vrdttmbt"><div class="header astro-kmkmnagf"> <div class="title-wrapper sl-flex astro-kmkmnagf"> <a href="/" class="site-title sl-flex astro-m46x6ez3">  <img class="astro-m46x6ez3" alt src="/_astro/luxe-dark.NVYNGKCT.svg" width="239" height="380">  <span class="astro-m46x6ez3" translate="no"> luxe docs </span> </a>  </div> <div class="sl-flex print:hidden astro-kmkmnagf"> <site-search class="astro-kmkmnagf astro-v37mnknz" data-translations="{&#34;placeholder&#34;:&#34;Search&#34;}"> <button data-open-modal disabled aria-label="Search" aria-keyshortcuts="Control+K" class="astro-v37mnknz"> <svg aria-hidden="true" class="astro-v37mnknz astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.71 20.29 18 16.61A9 9 0 1 0 16.61 18l3.68 3.68a.999.999 0 0 0 1.42 0 1 1 0 0 0 0-1.39ZM11 18a7 7 0 1 1 0-14 7 7 0 0 1 0 14Z"/></svg> <span class="sl-hidden md:sl-block astro-v37mnknz" aria-hidden="true">Search</span> <kbd class="sl-hidden md:sl-flex astro-v37mnknz" style="display: none;"> <kbd class="astro-v37mnknz">Ctrl</kbd><kbd class="astro-v37mnknz">K</kbd> </kbd> </button> <dialog style="padding:0" aria-label="Search" class="astro-v37mnknz"> <div class="dialog-frame sl-flex astro-v37mnknz">  <button data-close-modal class="sl-flex md:sl-hidden astro-v37mnknz"> Cancel </button> <div class="search-container astro-v37mnknz"> <div id="starlight__search" class="astro-v37mnknz"></div> </div> </div> </dialog> </site-search>  <script>
	(() => {
		const openBtn = document.querySelector('button[data-open-modal]');
		const shortcut = openBtn?.querySelector('kbd');
		if (!openBtn || !(shortcut instanceof HTMLElement)) return;
		const platformKey = shortcut.querySelector('kbd');
		if (platformKey && /(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)) {
			platformKey.textContent = 'âŒ˜';
			openBtn.setAttribute('aria-keyshortcuts', 'Meta+K');
		}
		shortcut.style.display = '';
	})();
</script> <script type="module" src="/_astro/Search.astro_astro_type_script_index_0_lang.cjYDvRdi.js"></script>   </div> <div class="sl-hidden md:sl-flex print:hidden right-group astro-kmkmnagf"> <div class="sl-flex social-icons astro-kmkmnagf"> <a href="https://github.com/withastro/starlight" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">GitHub</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg></a> </div> <starlight-kbd-picker class="astro-k5ijk5yq"> <label class="not-content astro-e2vmghfl"> <span class="sr-only astro-e2vmghfl">Select keyboard type</span> <svg xmlns="http://www.w3.org/2000/svg" class="icon label-icon astro-e2vmghfl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"> <path d="M6.21 13.29a.93.93 0 0 0-.33-.21 1 1 0 0 0-.76 0 .9.9 0 0 0-.54.54 1 1 0 1 0 1.84 0 1 1 0 0 0-.21-.33ZM13.5 11h1a1 1 0 0 0 0-2h-1a1 1 0 0 0 0 2Zm-4 0h1a1 1 0 0 0 0-2h-1a1 1 0 0 0 0 2Zm-3-2h-1a1 1 0 0 0 0 2h1a1 1 0 0 0 0-2ZM20 5H4a3 3 0 0 0-3 3v8a3 3 0 0 0 3 3h16a3 3 0 0 0 3-3V8a3 3 0 0 0-3-3Zm1 11a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1h16a1 1 0 0 1 1 1Zm-6-3H9a1 1 0 0 0 0 2h6a1 1 0 0 0 0-2Zm3.5-4h-1a1 1 0 0 0 0 2h1a1 1 0 0 0 0-2Zm.71 4.29a1 1 0 0 0-.33-.21 1 1 0 0 0-.76 0 .93.93 0 0 0-.33.21 1 1 0 0 0-.21.33 1 1 0 1 0 1.92.38.84.84 0 0 0-.08-.38 1 1 0 0 0-.21-.33Z" class="astro-e2vmghfl"></path> </svg> <select autocomplete="off" value="default" class="astro-e2vmghfl"> <option selected value="default" class="astro-e2vmghfl">Default Keys</option><option value="windows" class="astro-e2vmghfl">Windows</option><option value="mac" class="astro-e2vmghfl">macOS</option> </select> <svg aria-hidden="true" class="icon caret astro-e2vmghfl astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg> </label>  </starlight-kbd-picker> <script>
  StarlightKbdProvider.updateKbdPickers(typeof localStorage !== 'undefined' && localStorage.getItem('sl-kbd-type'))
</script> <script type="module">customElements.define("starlight-kbd-picker",class extends HTMLElement{constructor(){super(),this.querySelector("select")?.addEventListener("change",e=>{if(e.currentTarget instanceof HTMLSelectElement){StarlightKbdProvider.updateKbdPickers(e.currentTarget.value);for(const t of document.querySelectorAll("[data-sl-kbd-type]"))t.getAttribute("data-sl-kbd-type")===e.currentTarget.value?t.setAttribute("data-sl-kbd-active",""):t.removeAttribute("data-sl-kbd-active");typeof localStorage<"u"&&localStorage.setItem("sl-kbd-type",e.currentTarget.value)}})}});</script>  <starlight-theme-select>  <label style="--sl-select-width: 6.25em" class="astro-4yphtoen"> <span class="sr-only astro-4yphtoen">Select theme</span> <svg aria-hidden="true" class="icon label-icon astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg> <select autocomplete="off" class="astro-4yphtoen"> <option value="dark" class="astro-4yphtoen">Dark</option><option value="light" class="astro-4yphtoen">Light</option><option value="auto" selected class="astro-4yphtoen">Auto</option> </select> <svg aria-hidden="true" class="icon caret astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg> </label>  </starlight-theme-select>  <script>
	StarlightThemeProvider.updatePickers();
</script> <script type="module">const r="starlight-theme",o=e=>e==="auto"||e==="dark"||e==="light"?e:"auto",c=()=>o(typeof localStorage<"u"&&localStorage.getItem(r));function n(e){typeof localStorage<"u"&&localStorage.setItem(r,e==="light"||e==="dark"?e:"")}const l=()=>matchMedia("(prefers-color-scheme: light)").matches?"light":"dark";function t(e){StarlightThemeProvider.updatePickers(e),document.documentElement.dataset.theme=e==="auto"?l():e,n(e)}matchMedia("(prefers-color-scheme: light)").addEventListener("change",()=>{c()==="auto"&&t("auto")});class s extends HTMLElement{constructor(){super(),t(c()),this.querySelector("select")?.addEventListener("change",a=>{a.currentTarget instanceof HTMLSelectElement&&t(o(a.currentTarget.value))})}}customElements.define("starlight-theme-select",s);</script> <script type="module">class s extends HTMLElement{constructor(){super();const e=this.querySelector("select");e&&(e.addEventListener("change",t=>{t.currentTarget instanceof HTMLSelectElement&&(window.location.pathname=t.currentTarget.value)}),window.addEventListener("pageshow",t=>{if(!t.persisted)return;const n=e.querySelector("option[selected]")?.index;n!==e.selectedIndex&&(e.selectedIndex=n??0)}))}}customElements.define("starlight-lang-select",s);</script> </div> </div> </header> <nav class="sidebar print:hidden astro-vrdttmbt" aria-label="Main"> <starlight-menu-button class="print:hidden astro-jif73yzw"> <button aria-expanded="false" aria-label="Menu" aria-controls="starlight__sidebar" class="sl-flex md:sl-hidden astro-jif73yzw"> <svg aria-hidden="true" class="open-menu astro-jif73yzw astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M3 8h18a1 1 0 1 0 0-2H3a1 1 0 0 0 0 2Zm18 8H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Zm0-5H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Z"/></svg> <svg aria-hidden="true" class="close-menu astro-jif73yzw astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="m13.41 12 6.3-6.29a1.004 1.004 0 1 0-1.42-1.42L12 10.59l-6.29-6.3a1.004 1.004 0 0 0-1.42 1.42l6.3 6.29-6.3 6.29a1 1 0 0 0 0 1.42.998.998 0 0 0 1.42 0l6.29-6.3 6.29 6.3a.999.999 0 0 0 1.42 0 1 1 0 0 0 0-1.42L13.41 12Z"/></svg> </button> </starlight-menu-button> <script type="module">class s extends HTMLElement{constructor(){super(),this.btn=this.querySelector("button"),this.btn.addEventListener("click",()=>this.toggleExpanded());const t=this.closest("nav");t&&t.addEventListener("keyup",e=>this.closeOnEscape(e))}setExpanded(t){this.setAttribute("aria-expanded",String(t)),document.body.toggleAttribute("data-mobile-menu-expanded",t)}toggleExpanded(){this.setExpanded(this.getAttribute("aria-expanded")!=="true")}closeOnEscape(t){t.code==="Escape"&&(this.setExpanded(!1),this.btn.focus())}}customElements.define("starlight-menu-button",s);</script>   <div id="starlight__sidebar" class="sidebar-pane astro-vrdttmbt"> <div class="sidebar-content sl-flex astro-vrdttmbt"> <sl-sidebar-state-persist data-hash="02j6yr2" class="astro-kku4brbg"> <script aria-hidden="true">
		(() => {
			try {
				if (!matchMedia('(min-width: 50em)').matches) return;
				/** @type {HTMLElement | null} */
				const target = document.querySelector('sl-sidebar-state-persist');
				const state = JSON.parse(sessionStorage.getItem('sl-sidebar-state') || '0');
				if (!target || !state || target.dataset.hash !== state.hash) return;
				window._starlightScrollRestore = state.scroll;
				customElements.define(
					'sl-sidebar-restore',
					class SidebarRestore extends HTMLElement {
						connectedCallback() {
							try {
								const idx = parseInt(this.dataset.index || '');
								const details = this.closest('details');
								if (details && typeof state.open[idx] === 'boolean') details.open = state.open[idx];
							} catch {}
						}
					}
				);
			} catch {}
		})();
	</script>  <ul class="top-level astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Welcome</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="0"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/welcome/about/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">About</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/welcome/get/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Installing Luxe</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Getting Started</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="1"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/getting-started/luxe-101/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Luxe 101</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/getting-started/create-a-project/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Create and run a project</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/getting-started/draw-and-input/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Drawing and input</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/getting-started/world/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">World systems</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/getting-started/luxe-editor/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">The luxe editor</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/getting-started/build/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Making a build</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/getting-started/audio/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Adding sounds</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Tutorials</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="2"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Concepts</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="3"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/tutorials/concepts/overview/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Overview</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/tutorials/concepts/yarn/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Dialogue</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Cards &amp; Decks</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="4"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/tutorials/cards--decks/cardsdecks/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Cards &amp; Decks</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Match 3</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="5"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/tutorials/match-3/part1/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Match 3 - Game logic</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/tutorials/match-3/part2/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Match 3 - Animating changes</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/tutorials/match-3/part3/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Match 3 - After the prototype</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/tutorials/match-3/part4/" aria-current="page" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Match 3 - Sprite visuals</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Platformer</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="6"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/tutorials/platformer/platformer-first-steps/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">First steps</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/tutorials/platformer/platformer-next-steps/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Next steps</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/tutorials/platformer/platformer-the-rest/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">The rest</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Top down</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="7"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/tutorials/topdown/topdown-first-steps/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">First steps</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/tutorials/topdown/topdown-next-steps/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Next steps</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Manual</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="8"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/manual/overview/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Overview</span>  </a> </li><li class="astro-3ii7xxms"> <details class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">modules</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="9"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/manual/modules/modules/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Using Modules</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">project</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="10"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/manual/project/anatomy/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Anatomy</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">render</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="11"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/manual/render/draw/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Draw tool</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">scripting</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="12"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/manual/scripting/multiple-files/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Multiple Wren files</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/manual/scripting/random/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Random numbers</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">tools</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="13"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/manual/tools/save/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Save data</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">world</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="14"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/manual/world/camera/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Camera</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/manual/world/custom-modifiers/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Custom Modifiers</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/manual/world/states/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">States</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/manual/world/tilemaps/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Tile maps</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/manual/world/ui/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">UI</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/manual/world/wires/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Wires (events)</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="https://api.luxeengine.com/" aria-current="false" class="large astro-3ii7xxms"> <span class="astro-3ii7xxms">API reference</span>  </a> </li> </ul>   <script aria-hidden="true">
		(() => {
			const scroller = document.getElementById('starlight__sidebar');
			if (!window._starlightScrollRestore || !scroller) return;
			scroller.scrollTop = window._starlightScrollRestore;
			delete window._starlightScrollRestore;
		})();
	</script> </sl-sidebar-state-persist>  <div class="md:sl-hidden"> <div class="mobile-preferences sl-flex astro-wu23bvmt"> <div class="social-icons astro-wu23bvmt"> <a href="https://github.com/withastro/starlight" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">GitHub</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg></a> </div> <starlight-kbd-picker class="astro-k5ijk5yq"> <label class="not-content astro-e2vmghfl"> <span class="sr-only astro-e2vmghfl">Select keyboard type</span> <svg xmlns="http://www.w3.org/2000/svg" class="icon label-icon astro-e2vmghfl" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"> <path d="M6.21 13.29a.93.93 0 0 0-.33-.21 1 1 0 0 0-.76 0 .9.9 0 0 0-.54.54 1 1 0 1 0 1.84 0 1 1 0 0 0-.21-.33ZM13.5 11h1a1 1 0 0 0 0-2h-1a1 1 0 0 0 0 2Zm-4 0h1a1 1 0 0 0 0-2h-1a1 1 0 0 0 0 2Zm-3-2h-1a1 1 0 0 0 0 2h1a1 1 0 0 0 0-2ZM20 5H4a3 3 0 0 0-3 3v8a3 3 0 0 0 3 3h16a3 3 0 0 0 3-3V8a3 3 0 0 0-3-3Zm1 11a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1h16a1 1 0 0 1 1 1Zm-6-3H9a1 1 0 0 0 0 2h6a1 1 0 0 0 0-2Zm3.5-4h-1a1 1 0 0 0 0 2h1a1 1 0 0 0 0-2Zm.71 4.29a1 1 0 0 0-.33-.21 1 1 0 0 0-.76 0 .93.93 0 0 0-.33.21 1 1 0 0 0-.21.33 1 1 0 1 0 1.92.38.84.84 0 0 0-.08-.38 1 1 0 0 0-.21-.33Z" class="astro-e2vmghfl"></path> </svg> <select autocomplete="off" value="default" class="astro-e2vmghfl"> <option selected value="default" class="astro-e2vmghfl">Default Keys</option><option value="windows" class="astro-e2vmghfl">Windows</option><option value="mac" class="astro-e2vmghfl">macOS</option> </select> <svg aria-hidden="true" class="icon caret astro-e2vmghfl astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg> </label>  </starlight-kbd-picker> <script>
  StarlightKbdProvider.updateKbdPickers(typeof localStorage !== 'undefined' && localStorage.getItem('sl-kbd-type'))
</script>   <starlight-theme-select>  <label style="--sl-select-width: 6.25em" class="astro-4yphtoen"> <span class="sr-only astro-4yphtoen">Select theme</span> <svg aria-hidden="true" class="icon label-icon astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg> <select autocomplete="off" class="astro-4yphtoen"> <option value="dark" class="astro-4yphtoen">Dark</option><option value="light" class="astro-4yphtoen">Light</option><option value="auto" selected class="astro-4yphtoen">Auto</option> </select> <svg aria-hidden="true" class="icon caret astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg> </label>  </starlight-theme-select>  <script>
	StarlightThemeProvider.updatePickers();
</script>   </div>  </div> </div> </div> </nav> <div class="main-frame astro-vrdttmbt">  <script type="module">const a=document.getElementById("starlight__sidebar"),n=a?.querySelector("sl-sidebar-state-persist"),o="sl-sidebar-state",i=()=>{let t=[];const e=n?.dataset.hash||"";try{const s=sessionStorage.getItem(o),r=JSON.parse(s||"{}");Array.isArray(r.open)&&r.hash===e&&(t=r.open)}catch{}return{hash:e,open:t,scroll:a?.scrollTop||0}},c=t=>{try{sessionStorage.setItem(o,JSON.stringify(t))}catch{}},d=()=>c(i()),l=(t,e)=>{const s=i();s.open[e]=t,c(s)};n?.addEventListener("click",t=>{if(!(t.target instanceof Element))return;const e=t.target.closest("summary")?.closest("details");if(!e)return;const s=e.querySelector("sl-sidebar-restore"),r=parseInt(s?.dataset.index||"");isNaN(r)||l(!e.open,r)});addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&d()});addEventListener("pageHide",d);</script> <div class="lg:sl-flex astro-67yu43on"> <aside class="right-sidebar-container print:hidden astro-67yu43on"> <div class="right-sidebar astro-67yu43on"> <div class="lg:sl-hidden astro-pb3aqygn"><mobile-starlight-toc data-min-h="2" data-max-h="3" class="astro-doynk5tl"><nav aria-labelledby="starlight__on-this-page--mobile" class="astro-doynk5tl"><details id="starlight__mobile-toc" class="astro-doynk5tl"><summary id="starlight__on-this-page--mobile" class="sl-flex astro-doynk5tl"><span class="toggle sl-flex astro-doynk5tl">On this page<svg aria-hidden="true" class="caret astro-doynk5tl astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg></span><span class="display-current astro-doynk5tl"></span></summary><div class="dropdown astro-doynk5tl"><ul class="isMobile astro-g2bywc46" style="--depth: 0;"> <li class="astro-g2bywc46" style="--depth: 0;"> <a href="#_top" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Overview</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#see-it-in-motion" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">See it in motion</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#sprite-visuals-why" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Sprite visuals: why?</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#the-world-systems" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">The world systems</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#the-sprite-image-assets" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">The Sprite image assets</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#sprite-animation" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Sprite Animation</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#grid-change-events" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Grid change events</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#grid-change-data" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Grid change data</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#grid-change-wire" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Grid change wire</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#create-event" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Create event</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#timing" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Timing</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#grid-visual-change" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Grid Visual change</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#connecting-to-a-wire" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Connecting to a wire</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#system-vs-entity" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">System vs entity</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#creating-blocks-as-sprites" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Creating blocks as Sprites</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#tracking-and-cleaning-up" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Tracking and cleaning up</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#shapes" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Shapes</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#single-frame-animation" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Single frame animation</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#other-grid-events" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Other grid events</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#visuals-block-destroy-event" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Visuals: block destroy event</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#visuals-block-swap-event" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Visuals: block swap event</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#visuals-block-positions" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Visuals: block positions</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#grid-send-the-other-events" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Grid: send the other events</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#destroy-event-start" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Destroy event start</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#destroy-event-end" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Destroy event end</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#swap-event-start" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Swap event start</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#swap-event-end" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Swap event end</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#move-event-start" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Move event start</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#move-event-end" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Move event end</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#timing-polish" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Timing polish</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#the-result" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">The result</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#sprites-only" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Sprites only</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#bonus-no-randomness-random-seed" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Bonus: no randomness (Random seed)</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#bonus-speed-control" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Bonus: speed control</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#try-this-on-your-own" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Try this on your own</span> </a>  </li> </ul> </div></details></nav></mobile-starlight-toc><script type="module" src="/_astro/MobileTableOfContents.astro_astro_type_script_index_0_lang.C181hMzK.js"></script></div><div class="right-sidebar-panel sl-hidden lg:sl-block astro-pb3aqygn"><div class="sl-container astro-pb3aqygn"><starlight-toc data-min-h="2" data-max-h="3"><nav aria-labelledby="starlight__on-this-page"><h2 id="starlight__on-this-page">On this page</h2><ul class="astro-g2bywc46" style="--depth: 0;"> <li class="astro-g2bywc46" style="--depth: 0;"> <a href="#_top" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Overview</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#see-it-in-motion" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">See it in motion</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#sprite-visuals-why" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Sprite visuals: why?</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#the-world-systems" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">The world systems</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#the-sprite-image-assets" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">The Sprite image assets</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#sprite-animation" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Sprite Animation</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#grid-change-events" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Grid change events</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#grid-change-data" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Grid change data</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#grid-change-wire" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Grid change wire</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#create-event" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Create event</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#timing" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Timing</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#grid-visual-change" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Grid Visual change</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#connecting-to-a-wire" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Connecting to a wire</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#system-vs-entity" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">System vs entity</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#creating-blocks-as-sprites" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Creating blocks as Sprites</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#tracking-and-cleaning-up" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Tracking and cleaning up</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#shapes" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Shapes</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#single-frame-animation" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Single frame animation</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#other-grid-events" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Other grid events</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#visuals-block-destroy-event" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Visuals: block destroy event</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#visuals-block-swap-event" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Visuals: block swap event</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#visuals-block-positions" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Visuals: block positions</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#grid-send-the-other-events" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Grid: send the other events</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#destroy-event-start" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Destroy event start</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#destroy-event-end" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Destroy event end</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#swap-event-start" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Swap event start</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#swap-event-end" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Swap event end</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#move-event-start" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Move event start</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#move-event-end" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Move event end</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#timing-polish" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Timing polish</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#the-result" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">The result</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#sprites-only" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Sprites only</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#bonus-no-randomness-random-seed" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Bonus: no randomness (Random seed)</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#bonus-speed-control" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Bonus: speed control</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#try-this-on-your-own" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Try this on your own</span> </a>  </li> </ul> </nav></starlight-toc><script type="module" src="/_astro/TableOfContents.astro_astro_type_script_index_0_lang.CKWWgpjV.js"></script></div></div> </div> </aside> <div class="main-pane astro-67yu43on">  <main data-pagefind-body class="astro-bguv2lll" lang="en" dir="ltr">    <div class="content-panel astro-7nkwcw3z"> <div class="sl-container astro-7nkwcw3z"> <h1 id="_top" class="astro-j6tvhyss">Match 3 - Sprite visuals</h1>  </div> </div>  <div class="content-panel astro-7nkwcw3z"> <div class="sl-container astro-7nkwcw3z"> <div class="sl-markdown-content"> <span class="sl-badge success small astro-avdet4wd">Complexity: low</span>
<span class="sl-badge tip small astro-avdet4wd">Game Tutorial</span>
<br>
<br>
<aside aria-label="Outcome / Goals" class="starlight-aside starlight-aside--tip"><p class="starlight-aside__title" aria-hidden="true"><svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor" class="starlight-aside__icon"><path d="M17 22H5a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3h1a4 4 0 0 1 7.3-2.18c.448.64.692 1.4.7 2.18h3a1 1 0 0 1 1 1v3a4 4 0 0 1 2.18 7.3A3.86 3.86 0 0 1 18 18v3a1 1 0 0 1-1 1ZM5 8a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h11v-3.18a1 1 0 0 1 1.33-.95 1.77 1.77 0 0 0 1.74-.23 2 2 0 0 0 .93-1.37 2 2 0 0 0-.48-1.59 1.89 1.89 0 0 0-2.17-.55 1 1 0 0 1-1.33-.95V8h-3.2a1 1 0 0 1-1-1.33 1.77 1.77 0 0 0-.23-1.74 1.939 1.939 0 0 0-3-.43A2 2 0 0 0 8 6c.002.23.046.456.13.67A1 1 0 0 1 7.18 8H5Z"></path></svg>Outcome / Goals</p><div class="starlight-aside__content"><p>In this tutorial weâ€™ll:</p><ul>
<li>Use <code dir="auto">Sprite</code> instead of <code dir="auto">Draw</code> to visualize the blocks</li>
</ul></div></aside>
<div class="sl-heading-wrapper level-h2"><h2 id="see-it-in-motion">See it in motion</h2><a class="sl-anchor-link" href="#see-it-in-motion"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œSee it in motionâ€</span></a></div>
<p>Hereâ€™s the end result, with sprites and animations!</p>
<video preload="auto" autoplay controls muted playsinline loop style="max-width:100%; width:auto; margin:auto; display:block;"> <source src="/video/tutorials/match3/grid.noshapes.mp4" type="video/mp4"> </video>
<div class="sl-heading-wrapper level-h2"><h2 id="sprite-visuals-why">Sprite visuals: why?</h2><a class="sl-anchor-link" href="#sprite-visuals-why"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œSprite visuals: why?â€</span></a></div>
<p>Thereâ€™s nothing wrong with our current visuals, we could easily use <code dir="auto">Draw</code> and polish things up and call it a day!</p>
<p>Though, luxe provides tools that are higher level, and make a lot of things easier, like animation, sprite effects and more.</p>
<p>(Plus this is a tutorial on taking a game from a prototype to a structured project!)</p>
<p>So the next step makes sense to use sprites instead of just shapes.</p>
<div class="sl-heading-wrapper level-h2"><h2 id="the-world-systems">The world systems</h2><a class="sl-anchor-link" href="#the-world-systems"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œThe world systemsâ€</span></a></div>
<p>We made our grid use <code dir="auto">Transform</code>, which means our sprites can be <strong>linked</strong> to the grid,
and theyâ€™ll automatically follow and scale as the grid does. It would still allow local transform changes,
like falling and swapping as offsets like we had before.</p>
<p><code dir="auto">Sprite</code> provides effects, like outlines, shadows, shine and others we can use to give feedback and add polish.</p>
<p>We can also use <code dir="auto">Anim</code> with the <code dir="auto">Sprite</code> modifier to animate sprite frames, if our blocks had</p>
<div class="sl-heading-wrapper level-h2"><h2 id="the-sprite-image-assets">The Sprite image assets</h2><a class="sl-anchor-link" href="#the-sprite-image-assets"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œThe Sprite image assetsâ€</span></a></div>
<p>Weâ€™ve made a few sprites for this tutorial. You can save these images into your project folder under <code dir="auto">image/</code>:</p>
<starlight-file-tree class="not-content astro-p67cqifm" data-pagefind-ignore="true"><ul><li class="file empty"><span class="tree-entry"><span class="">â€¦</span></span></li><li class="directory"><details open><summary><span class="tree-entry"><span class="highlight"><span><span class="sr-only">Directory</span><svg width="16" height="16" class="tree-icon" aria-hidden="true" viewBox="0 0 24 24"><path d="M22.073 4.900L22.073 4.900L12.148 4.900L12.148 3.950Q12.148 3.125 11.585 2.563Q11.023 2 10.198 2L10.198 2L0.048 2L0.048 22L23.948 22L23.948 6.850Q23.998 6.025 23.448 5.462Q22.898 4.900 22.073 4.900Z"></path></svg></span><strong>image/</strong></span> <span class="comment">  - create this, and add the files into this folder
</span></span></summary><ul><li class="file"><span class="tree-entry"><span class="highlight"><span><svg width="16" height="16" class="tree-icon" aria-hidden="true" viewBox="0 0 24 24"><path d="M18.640 13.480L18.640 13.480Q19.560 13.480 20.220 12.840Q20.880 12.200 20.880 11.260Q20.880 10.320 20.220 9.660Q19.560 9 18.620 9Q17.680 9 17.020 9.660Q16.360 10.320 16.360 11.260Q16.360 12.200 17.020 12.840Q17.680 13.480 18.640 13.480ZM23.880 6.640L4.760 6.640L4.760 22.120L23.880 22.120L23.880 6.640ZM5.640 19L5.640 7.480L23 7.480L23 21L18.520 15.880L15.760 19.120L10.240 13.240L5.640 19ZM17.880 4L17.880 1.880L0.120 1.880L0.120 15.360L2.520 15.360L2.520 4L17.880 4Z"></path></svg></span><strong>hexagon.png</strong></span></span></li><li class="file"><span class="tree-entry"><span class="highlight"><span><svg width="16" height="16" class="tree-icon" aria-hidden="true" viewBox="0 0 24 24"><path d="M18.640 13.480L18.640 13.480Q19.560 13.480 20.220 12.840Q20.880 12.200 20.880 11.260Q20.880 10.320 20.220 9.660Q19.560 9 18.620 9Q17.680 9 17.020 9.660Q16.360 10.320 16.360 11.260Q16.360 12.200 17.020 12.840Q17.680 13.480 18.640 13.480ZM23.880 6.640L4.760 6.640L4.760 22.120L23.880 22.120L23.880 6.640ZM5.640 19L5.640 7.480L23 7.480L23 21L18.520 15.880L15.760 19.120L10.240 13.240L5.640 19ZM17.880 4L17.880 1.880L0.120 1.880L0.120 15.360L2.520 15.360L2.520 4L17.880 4Z"></path></svg></span><strong>pentagon.png</strong></span></span></li><li class="file"><span class="tree-entry"><span class="highlight"><span><svg width="16" height="16" class="tree-icon" aria-hidden="true" viewBox="0 0 24 24"><path d="M18.640 13.480L18.640 13.480Q19.560 13.480 20.220 12.840Q20.880 12.200 20.880 11.260Q20.880 10.320 20.220 9.660Q19.560 9 18.620 9Q17.680 9 17.020 9.660Q16.360 10.320 16.360 11.260Q16.360 12.200 17.020 12.840Q17.680 13.480 18.640 13.480ZM23.880 6.640L4.760 6.640L4.760 22.120L23.880 22.120L23.880 6.640ZM5.640 19L5.640 7.480L23 7.480L23 21L18.520 15.880L15.760 19.120L10.240 13.240L5.640 19ZM17.880 4L17.880 1.880L0.120 1.880L0.120 15.360L2.520 15.360L2.520 4L17.880 4Z"></path></svg></span><strong>square.png</strong></span></span></li><li class="file"><span class="tree-entry"><span class="highlight"><span><svg width="16" height="16" class="tree-icon" aria-hidden="true" viewBox="0 0 24 24"><path d="M18.640 13.480L18.640 13.480Q19.560 13.480 20.220 12.840Q20.880 12.200 20.880 11.260Q20.880 10.320 20.220 9.660Q19.560 9 18.620 9Q17.680 9 17.020 9.660Q16.360 10.320 16.360 11.260Q16.360 12.200 17.020 12.840Q17.680 13.480 18.640 13.480ZM23.880 6.640L4.760 6.640L4.760 22.120L23.880 22.120L23.880 6.640ZM5.640 19L5.640 7.480L23 7.480L23 21L18.520 15.880L15.760 19.120L10.240 13.240L5.640 19ZM17.880 4L17.880 1.880L0.120 1.880L0.120 15.360L2.520 15.360L2.520 4L17.880 4Z"></path></svg></span><strong>star.png</strong></span></span></li><li class="file"><span class="tree-entry"><span class="highlight"><span><svg width="16" height="16" class="tree-icon" aria-hidden="true" viewBox="0 0 24 24"><path d="M18.640 13.480L18.640 13.480Q19.560 13.480 20.220 12.840Q20.880 12.200 20.880 11.260Q20.880 10.320 20.220 9.660Q19.560 9 18.620 9Q17.680 9 17.020 9.660Q16.360 10.320 16.360 11.260Q16.360 12.200 17.020 12.840Q17.680 13.480 18.640 13.480ZM23.880 6.640L4.760 6.640L4.760 22.120L23.880 22.120L23.880 6.640ZM5.640 19L5.640 7.480L23 7.480L23 21L18.520 15.880L15.760 19.120L10.240 13.240L5.640 19ZM17.880 4L17.880 1.880L0.120 1.880L0.120 15.360L2.520 15.360L2.520 4L17.880 4Z"></path></svg></span><strong>triangle.png</strong></span></span></li></ul></details></li><li class="directory"><details><summary><span class="tree-entry"><span class=""><span><span class="sr-only">Directory</span><svg width="16" height="16" class="tree-icon" aria-hidden="true" viewBox="0 0 24 24"><path d="M22.073 4.900L22.073 4.900L12.148 4.900L12.148 3.950Q12.148 3.125 11.585 2.563Q11.023 2 10.198 2L10.198 2L0.048 2L0.048 22L23.948 22L23.948 6.850Q23.998 6.025 23.448 5.462Q22.898 4.900 22.073 4.900Z"></path></svg></span>luxe.project/</span></span></summary><ul><li class="file empty"><span class="tree-entry"><span class="">â€¦</span></span></li></ul></details></li><li class="directory"><details><summary><span class="tree-entry"><span class=""><span><span class="sr-only">Directory</span><svg width="16" height="16" class="tree-icon" aria-hidden="true" viewBox="0 0 24 24"><path d="M22.073 4.900L22.073 4.900L12.148 4.900L12.148 3.950Q12.148 3.125 11.585 2.563Q11.023 2 10.198 2L10.198 2L0.048 2L0.048 22L23.948 22L23.948 6.850Q23.998 6.025 23.448 5.462Q22.898 4.900 22.073 4.900Z"></path></svg></span>outline/</span></span></summary><ul><li class="file empty"><span class="tree-entry"><span class="">â€¦</span></span></li></ul></details></li><li class="directory"><details><summary><span class="tree-entry"><span class=""><span><span class="sr-only">Directory</span><svg width="16" height="16" class="tree-icon" aria-hidden="true" viewBox="0 0 24 24"><path d="M22.073 4.900L22.073 4.900L12.148 4.900L12.148 3.950Q12.148 3.125 11.585 2.563Q11.023 2 10.198 2L10.198 2L0.048 2L0.048 22L23.948 22L23.948 6.850Q23.998 6.025 23.448 5.462Q22.898 4.900 22.073 4.900Z"></path></svg></span>system/</span></span></summary><ul><li class="file empty"><span class="tree-entry"><span class="">â€¦</span></span></li></ul></details></li><li class="file"><span class="tree-entry"><span class=""><span><svg width="16" height="16" class="tree-icon" aria-hidden="true" viewBox="0 0 24 24"><path d="M1.082 16.876L1.082 14.014L22.918 14.014L22.918 16.876L1.082 16.876ZM1.082 9.986L1.082 7.071L13.272 7.071L13.272 9.986L1.082 9.986ZM1.082 3.096L1.082 0.181L22.918 0.181L22.918 3.096L1.082 3.096ZM1.082 23.819L1.082 20.904L17.300 20.904L17.300 23.819L1.082 23.819Z"></path></svg></span>game.wren</span></span></li><li class="file"><span class="tree-entry"><span class=""><span><svg width="16" height="16" class="tree-icon" aria-hidden="true" viewBox="0 0 24 24"><path d="M1.082 16.876L1.082 14.014L22.918 14.014L22.918 16.876L1.082 16.876ZM1.082 9.986L1.082 7.071L13.272 7.071L13.272 9.986L1.082 9.986ZM1.082 3.096L1.082 0.181L22.918 0.181L22.918 3.096L1.082 3.096ZM1.082 23.819L1.082 20.904L17.300 20.904L17.300 23.819L1.082 23.819Z"></path></svg></span>project.luxe</span></span></li></ul></starlight-file-tree> 
<hr>
<p>Star - <a href="/images/tutorials/match3/star.png">Download</a>:</p>
<img src="/images/tutorials/match3/star.png" alt>
<hr>
<p>Circle - <a href="/images/tutorials/match3/circle.png">Download</a>:</p>
<img src="/images/tutorials/match3/circle.png" alt>
<hr>
<p>Triangle - <a href="/images/tutorials/match3/triangle.png">Download</a>:</p>
<img src="/images/tutorials/match3/triangle.png" alt>
<hr>
<p>Square - <a href="/images/tutorials/match3/square.png">Download</a>:</p>
<img src="/images/tutorials/match3/square.png" alt>
<hr>
<p>Pentagon - <a href="/images/tutorials/match3/pentagon.png">Download</a>:</p>
<img src="/images/tutorials/match3/pentagon.png" alt>
<hr>
<p>Hexagon - <a href="/images/tutorials/match3/hexagon.png">Download</a>:</p>
<img src="/images/tutorials/match3/hexagon.png" alt>
<div class="sl-heading-wrapper level-h2"><h2 id="sprite-animation">Sprite Animation</h2><a class="sl-anchor-link" href="#sprite-animation"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œSprite Animationâ€</span></a></div>
<p>Letâ€™s display a sprite in the middle of the screen, and animate it.</p>
<p>Add the following lines and read through them:</p>
<div class="expressive-code"><link rel="stylesheet" href="/_astro/ec.9unvh.css"><script type="module" src="/_astro/ec.p1z7b.js"></script><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="wren"><code><div class="ec-line"><div class="code"><span style="--0:#E5C890;--1:#8B5912">construct</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">ready</span><span style="--0:#C6D0F5;--1:#4C4F69">() {</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">super</span><span style="--0:#C6D0F5;--1:#4C4F69">(</span><span style="--0:#A6D189;--1:#2D711E">"ready! %(</span><span style="--0:#C6D0F5;--1:#4C4F69">width</span><span style="--0:#A6D189;--1:#2D711E">) x %(</span><span style="--0:#C6D0F5;--1:#4C4F69">height</span><span style="--0:#A6D189;--1:#2D711E">) @ %(</span><span style="--0:#C6D0F5;--1:#4C4F69">scale</span><span style="--0:#A6D189;--1:#2D711E">)x"</span><span style="--0:#C6D0F5;--1:#4C4F69">)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">  </span></span><span style="--0:#C6D0F5;--1:#4C4F69">grid </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Entity</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">create</span><span style="--0:#C6D0F5;--1:#4C4F69">(world, </span><span style="--0:#A6D189;--1:#2D711E">"grid"</span><span style="--0:#C6D0F5;--1:#4C4F69">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Grid</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">create</span><span style="--0:#C6D0F5;--1:#4C4F69">(grid)</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">GridInput</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">create</span><span style="--0:#C6D0F5;--1:#4C4F69">(grid)</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">GridVisuals</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">create</span><span style="--0:#C6D0F5;--1:#4C4F69">(grid)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Transform</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">create</span><span style="--0:#C6D0F5;--1:#4C4F69">(grid)</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Transform</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">set_pos</span><span style="--0:#C6D0F5;--1:#4C4F69">(grid, </span><span style="--0:#EF9F76;--1:#AB4307">64</span><span style="--0:#C6D0F5;--1:#4C4F69">, </span><span style="--0:#EF9F76;--1:#AB4307">64</span><span style="--0:#C6D0F5;--1:#4C4F69">)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#cfa8e9;--1:#6429af">var</span><span style="--0:#C6D0F5;--1:#474a62"> entity </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">Entity</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">create</span><span style="--0:#C6D0F5;--1:#474a62">(world)</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">Anim</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">create</span><span style="--0:#C6D0F5;--1:#474a62">(entity)</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">Sprite</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">create</span><span style="--0:#C6D0F5;--1:#474a62">(entity, </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">Assets</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">image</span><span style="--0:#C6D0F5;--1:#474a62">(</span><span style="--0:#A6D189;--1:#235817">"image/star"</span><span style="--0:#C6D0F5;--1:#474a62">))</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">Sprite</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">set_auto_size</span><span style="--0:#C6D0F5;--1:#474a62">(entity, </span><span style="--0:#A6D189;--1:#235817">false</span><span style="--0:#C6D0F5;--1:#474a62">)</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">Sprite</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">set_size</span><span style="--0:#C6D0F5;--1:#474a62">(entity, </span><span style="--0:#f0a57f;--1:#833305">256</span><span style="--0:#C6D0F5;--1:#474a62">, </span><span style="--0:#f0a57f;--1:#833305">256</span><span style="--0:#C6D0F5;--1:#474a62">)</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">Transform</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">create</span><span style="--0:#C6D0F5;--1:#474a62">(entity)</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">Transform</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">set_pos</span><span style="--0:#C6D0F5;--1:#474a62">(entity, width</span><span style="--0:#81C8BE;--1:#0d5458">/</span><span style="--0:#f0a57f;--1:#833305">2</span><span style="--0:#C6D0F5;--1:#474a62">, height</span><span style="--0:#81C8BE;--1:#0d5458">/</span><span style="--0:#f0a57f;--1:#833305">2</span><span style="--0:#C6D0F5;--1:#474a62">)</span></div></div><div class="ec-line highlight ins"><div class="code">
</div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">Sprite</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">animate</span><span style="--0:#C6D0F5;--1:#474a62">(entity)</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">        </span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">loop</span><span style="--0:#C6D0F5;--1:#474a62">()</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">        </span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">grid</span><span style="--0:#C6D0F5;--1:#474a62">(</span><span style="--0:#f0a57f;--1:#833305">4</span><span style="--0:#C6D0F5;--1:#474a62">,</span><span style="--0:#f0a57f;--1:#833305">6</span><span style="--0:#C6D0F5;--1:#474a62">, </span><span style="--0:#f0a57f;--1:#833305">1</span><span style="--0:#C6D0F5;--1:#474a62">,</span><span style="--0:#f0a57f;--1:#833305">24</span><span style="--0:#C6D0F5;--1:#474a62">)</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">        </span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">commit</span><span style="--0:#C6D0F5;--1:#474a62">()</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C6D0F5;--1:#4C4F69">} </span><span style="--0:#949CBB;--0fs:italic;--1:#616373;--1fs:italic">//ready</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="construct ready() {  super(&#x22;ready! %(width) x %(height) @ %(scale)x&#x22;)  grid = Entity.create(world, &#x22;grid&#x22;)  Grid.create(grid)  GridInput.create(grid)  GridVisuals.create(grid)  Transform.create(grid)  Transform.set_pos(grid, 64, 64)  var entity = Entity.create(world)  Anim.create(entity)  Sprite.create(entity, Assets.image(&#x22;image/star&#x22;))  Sprite.set_auto_size(entity, false)  Sprite.set_size(entity, 256, 256)  Transform.create(entity)  Transform.set_pos(entity, width/2, height/2)  Sprite.animate(entity)        .loop()        .grid(4,6, 1,24)        .commit()} //ready"><div></div></button></div></figure></div>
<video preload="auto" autoplay controls muted playsinline loop style="max-width:100%; width:auto; margin:auto; display:block;"> <source src="/video/tutorials/match3/sprite.animate.mp4" type="video/mp4"> </video>
<div class="sl-heading-wrapper level-h2"><h2 id="grid-change-events">Grid change events</h2><a class="sl-anchor-link" href="#grid-change-events"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œGrid change eventsâ€</span></a></div>
<p>In order for the grid visual system to know when to create/destroy a sprite, weâ€™ll send events from the grid using <strong>Wires</strong>.</p>
<p>Wires send events for other systems to listen to, and they can also send typed data across the wire.</p>
<div class="sl-heading-wrapper level-h3"><h3 id="grid-change-data">Grid change data</h3><a class="sl-anchor-link" href="#grid-change-data"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œGrid change dataâ€</span></a></div>
<p>Since our event is going to need to send some info like the x/y location, the kind of block, and the change type, weâ€™ll need to create a data block for that!</p>
<p>To do that we create a <code dir="auto">.block.wren</code> file,</p>
<ol role="list" class="sl-steps">
<li>
<div class="sl-heading-wrapper level-h4"><h4 id="systemgrid_changeblockwren"><code dir="auto">system/grid_change.block.wren</code></h4><a class="sl-anchor-link" href="#systemgrid_changeblockwren"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œsystem/grid_change.block.wrenâ€</span></a></div>
<p>Create an empty <strong>file</strong> named <code dir="auto">grid_change.block.wren</code> in the <code dir="auto">system/</code> folder.
Weâ€™ll keep this alongside our grid system.</p>
</li>
<li>
<div class="sl-heading-wrapper level-h4"><h4 id="add-the-data-class-contents">Add the data class contents</h4><a class="sl-anchor-link" href="#add-the-data-class-contents"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œAdd the data class contentsâ€</span></a></div>
<p>This is similar to our <code dir="auto">Data</code> class in a modifier, itâ€™s just a standalone data type.</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="wren"><code><div class="ec-line"><div class="code"><span style="--0:#949CBB;--0fs:italic;--1:#616373;--1fs:italic">#block = data</span></div></div><div class="ec-line"><div class="code"><span style="--0:#CA9EE6;--1:#8035E0">class</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">GridChange</span><span style="--0:#C6D0F5;--1:#4C4F69"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#949CBB;--0fs:italic;--1:#616373;--1fs:italic">#doc = "The change kind"</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> change: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">GridChangeType</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">GridChangeType</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">none</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#949CBB;--0fs:italic;--1:#616373;--1fs:italic">#doc = "Whether this is the start or end event (default true)"</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> start: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Bool</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#A6D189;--1:#2D711E">true</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#949CBB;--0fs:italic;--1:#616373;--1fs:italic">#doc = "The grid coordinate for the block"</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> coord: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Float2</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> [</span><span style="--0:#EF9F76;--1:#AB4307">-1</span><span style="--0:#C6D0F5;--1:#4C4F69">, </span><span style="--0:#EF9F76;--1:#AB4307">-1</span><span style="--0:#C6D0F5;--1:#4C4F69">]</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#949CBB;--0fs:italic;--1:#616373;--1fs:italic">#doc = "The grid coordinate for the other block (swap only)"</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> other: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Float2</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> [</span><span style="--0:#EF9F76;--1:#AB4307">-1</span><span style="--0:#C6D0F5;--1:#4C4F69">, </span><span style="--0:#EF9F76;--1:#AB4307">-1</span><span style="--0:#C6D0F5;--1:#4C4F69">]</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#949CBB;--0fs:italic;--1:#616373;--1fs:italic">#doc = "The kind of block"</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> kind: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Num</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#EF9F76;--1:#AB4307">-1</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C6D0F5;--1:#4C4F69">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#949CBB;--0fs:italic;--1:#616373;--1fs:italic">#option</span></div></div><div class="ec-line"><div class="code"><span style="--0:#CA9EE6;--1:#8035E0">class</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">GridChangeType</span><span style="--0:#C6D0F5;--1:#4C4F69"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--1:#8B5912">static</span><span style="--0:#C6D0F5;--1:#4C4F69"> none { </span><span style="--0:#A6D189;--1:#2D711E">"none"</span><span style="--0:#C6D0F5;--1:#4C4F69"> }</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--1:#8B5912">static</span><span style="--0:#C6D0F5;--1:#4C4F69"> create { </span><span style="--0:#A6D189;--1:#2D711E">"create"</span><span style="--0:#C6D0F5;--1:#4C4F69"> }</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--1:#8B5912">static</span><span style="--0:#C6D0F5;--1:#4C4F69"> destroy { </span><span style="--0:#A6D189;--1:#2D711E">"destroy"</span><span style="--0:#C6D0F5;--1:#4C4F69"> }</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--1:#8B5912">static</span><span style="--0:#C6D0F5;--1:#4C4F69"> swap { </span><span style="--0:#A6D189;--1:#2D711E">"swap"</span><span style="--0:#C6D0F5;--1:#4C4F69"> }</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C6D0F5;--1:#4C4F69">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="#block = dataclass GridChange {  #doc = &#x22;The change kind&#x22;  var change: GridChangeType = GridChangeType.none  #doc = &#x22;Whether this is the start or end event (default true)&#x22;  var start: Bool = true  #doc = &#x22;The grid coordinate for the block&#x22;  var coord: Float2 = [-1, -1]  #doc = &#x22;The grid coordinate for the other block (swap only)&#x22;  var other: Float2 = [-1, -1]  #doc = &#x22;The kind of block&#x22;  var kind: Num = -1}#optionclass GridChangeType {  static none { &#x22;none&#x22; }  static create { &#x22;create&#x22; }  static destroy { &#x22;destroy&#x22; }  static swap { &#x22;swap&#x22; }}"><div></div></button></div></figure></div>
</li>
</ol>
<div class="sl-heading-wrapper level-h3"><h3 id="grid-change-wire">Grid <code dir="auto">change</code> wire</h3><a class="sl-anchor-link" href="#grid-change-wire"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œGrid change wireâ€</span></a></div>
<p>Before we add the wire, weâ€™re going to import the new type we made.
At the top of our <code dir="auto">grid.modifier.wren</code> file, we can import this:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">system/grid.modifier.wren</span></figcaption><pre data-language="wren"><code><div class="ec-line"><div class="code"><span style="--0:#CA9EE6;--1:#8035E0">import</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#A6D189;--1:#2D711E">"system/grid_change.block"</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#CA9EE6;--1:#8035E0">for</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">GridChange</span><span style="--0:#C6D0F5;--1:#4C4F69">, </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">GridChangeType</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import &#x22;system/grid_change.block&#x22; for GridChange, GridChangeType"><div></div></button></div></figure></div>
<p><a href="/manual/world/wires">An outgoing wire</a> requires making a wire variable and tagging it with an number ID.</p>
<p>In the variable section of our <code dir="auto">System</code> class, we add a new wire variable like this:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">system/grid.modifier.wren...System</span></figcaption><pre data-language="wren"><code><div class="ec-line"><div class="code"><span style="--0:#CA9EE6;--1:#8035E0">class</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">System</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#CA9EE6;--1:#8035E0">is</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Modifier</span><span style="--0:#C6D0F5;--1:#4C4F69"> {</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> rng: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Random</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Random</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#CA9EE6;--1:#8035E0">new</span><span style="--0:#C6D0F5;--1:#4C4F69">()</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#b0b6cd;--0fs:italic;--1:#4a4c58;--1fs:italic">#wire = 1</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#b0b6cd;--0fs:italic;--1:#4a4c58;--1fs:italic">#type = "system/grid_change.block"</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#cfa8e9;--1:#6429af">var</span><span style="--0:#C6D0F5;--1:#474a62"> change: </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">Wire</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">Wire</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">create</span><span style="--0:#C6D0F5;--1:#474a62">()</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="class System is Modifier {  var rng: Random = Random.new()  #wire = 1  #type = &#x22;system/grid_change.block&#x22;  var change: Wire = Wire.create()"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h3"><h3 id="create-event">Create event</h3><a class="sl-anchor-link" href="#create-event"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œCreate eventâ€</span></a></div>
<p>We have two places that create blocks: <code dir="auto">fill_top</code> and <code dir="auto">reset_grid</code>.
Weâ€™ll add a new helper function called <code dir="auto">create_block()</code> inside our <code dir="auto">System</code> class in <code dir="auto">grid.modifier.wren</code>.</p>
<p>This is where weâ€™ll use the new wire we created.</p>
<p>The wire offers a <code dir="auto">prepare()</code> function, which returns the data object weâ€™ll send.
We configure it first, and then send the event along with our data.</p>
<p>We also move our actual grid change into here for convenience.</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">system/grid.modifier.wren...System</span></figcaption><pre data-language="wren"><code><div class="ec-line"><div class="code"><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">create_block</span><span style="--0:#C6D0F5;--1:#4C4F69">(data: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Data</span><span style="--0:#C6D0F5;--1:#4C4F69">, x: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Num</span><span style="--0:#C6D0F5;--1:#4C4F69">, y: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Num</span><span style="--0:#C6D0F5;--1:#4C4F69">, kind: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Num</span><span style="--0:#C6D0F5;--1:#4C4F69">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">set_cell</span><span style="--0:#C6D0F5;--1:#4C4F69">(data, x, y, kind)</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> event: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">GridChange</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> change</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">prepare</span><span style="--0:#C6D0F5;--1:#4C4F69">()</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">      </span></span><span style="--0:#C6D0F5;--1:#4C4F69">event</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">coord </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> [x, y]</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">      </span></span><span style="--0:#C6D0F5;--1:#4C4F69">event</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">change </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">GridChangeType</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">create</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">      </span></span><span style="--0:#C6D0F5;--1:#4C4F69">event</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">kind </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> kind</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">  </span></span><span style="--0:#C6D0F5;--1:#4C4F69">change</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">send</span><span style="--0:#C6D0F5;--1:#4C4F69">(data</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">entity, event)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C6D0F5;--1:#4C4F69">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="create_block(data: Data, x: Num, y: Num, kind: Num) {  set_cell(data, x, y, kind)  var event: GridChange = change.prepare()      event.coord = [x, y]      event.change = GridChangeType.create      event.kind = kind  change.send(data.entity, event)}"><div></div></button></div></figure></div>
<p>Weâ€™ll change the two places where a block is created, and have them call this instead. In <code dir="auto">reset_grid</code>:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">system/grid.modifier.wren...System</span></figcaption><pre data-language="wren"><code><div class="ec-line"><div class="code"><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">reset_grid</span><span style="--0:#C6D0F5;--1:#4C4F69">(data: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Data</span><span style="--0:#C6D0F5;--1:#4C4F69">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">for</span><span style="--0:#C6D0F5;--1:#4C4F69"> (y </span><span style="--0:#CA9EE6;--1:#8035E0">in</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#EF9F76;--1:#AB4307">0</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#81C8BE;--1:#116E73">...</span><span style="--0:#C6D0F5;--1:#4C4F69"> data</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">height) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#CA9EE6;--1:#8035E0">for</span><span style="--0:#C6D0F5;--1:#4C4F69"> (x </span><span style="--0:#CA9EE6;--1:#8035E0">in</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#EF9F76;--1:#AB4307">0</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#81C8BE;--1:#116E73">...</span><span style="--0:#C6D0F5;--1:#4C4F69"> data</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">width) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> kind </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">safe_tile</span><span style="--0:#C6D0F5;--1:#4C4F69">(data, x, y)</span></div></div><div class="ec-line highlight del"><div class="code"><span class="indent">      </span><span style="--0:#99b4f0;--0fs:italic;--1:#1444a4;--1fs:italic">set_cell</span><span style="--0:#C6D0F5;--1:#45485f">(data, x, y, kind)</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">      </span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">create_block</span><span style="--0:#C6D0F5;--1:#474a62">(data, x, y, kind)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">    </span></span><span style="--0:#C6D0F5;--1:#4C4F69">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">  </span></span><span style="--0:#C6D0F5;--1:#4C4F69">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C6D0F5;--1:#4C4F69">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="reset_grid(data: Data) {  for (y in 0 ... data.height) {    for (x in 0 ... data.width) {      var kind = safe_tile(data, x, y)      set_cell(data, x, y, kind)      create_block(data, x, y, kind)    }  }}"><div></div></button></div></figure></div>
<p>And then <code dir="auto">fill_top</code> as well:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">system/grid.modifier.wren...System</span></figcaption><pre data-language="wren"><code><div class="ec-line"><div class="code"><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">fill_top</span><span style="--0:#C6D0F5;--1:#4C4F69">(data: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Data</span><span style="--0:#C6D0F5;--1:#4C4F69">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">for</span><span style="--0:#C6D0F5;--1:#4C4F69"> (x </span><span style="--0:#CA9EE6;--1:#8035E0">in</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#EF9F76;--1:#AB4307">0</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#81C8BE;--1:#116E73">...</span><span style="--0:#C6D0F5;--1:#4C4F69"> data</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">width) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#CA9EE6;--1:#8035E0">for</span><span style="--0:#C6D0F5;--1:#4C4F69"> (y </span><span style="--0:#CA9EE6;--1:#8035E0">in</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#EF9F76;--1:#AB4307">0</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#81C8BE;--1:#116E73">...</span><span style="--0:#C6D0F5;--1:#4C4F69"> data</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">height) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#CA9EE6;--1:#8035E0">if</span><span style="--0:#C6D0F5;--1:#4C4F69"> (</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">get_cell</span><span style="--0:#C6D0F5;--1:#4C4F69">(data, x, y) </span><span style="--0:#81C8BE;--1:#116E73">==</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#EF9F76;--1:#AB4307">0</span><span style="--0:#C6D0F5;--1:#4C4F69">) {</span></div></div><div class="ec-line highlight del"><div class="code"><span class="indent">        </span><span style="--0:#99b4f0;--0fs:italic;--1:#1444a4;--1fs:italic">set_cell</span><span style="--0:#C6D0F5;--1:#45485f">(data, x, y, rng</span><span style="--0:#81C8BE;--1:#0d5356">.</span><span style="--0:#99b4f0;--0fs:italic;--1:#1444a4;--1fs:italic">int</span><span style="--0:#C6D0F5;--1:#45485f">(data</span><span style="--0:#81C8BE;--1:#0d5356">.</span><span style="--0:#C6D0F5;--1:#45485f">block_kinds) </span><span style="--0:#81C8BE;--1:#0d5356">+</span><span style="--0:#C6D0F5;--1:#45485f"> </span><span style="--0:#f0a27a;--1:#803205">1</span><span style="--0:#C6D0F5;--1:#45485f">)</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">        </span><span style="--0:#cfa8e9;--1:#6429af">var</span><span style="--0:#C6D0F5;--1:#474a62"> kind </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> rng</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">int</span><span style="--0:#C6D0F5;--1:#474a62">(data</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">block_kinds) </span><span style="--0:#81C8BE;--1:#0d5458">+</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#f0a57f;--1:#833305">1</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">        </span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">create_block</span><span style="--0:#C6D0F5;--1:#474a62">(data, x, y, kind)</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">mark_busy</span><span style="--0:#C6D0F5;--1:#4C4F69">(x, y, </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">CREATE)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">      </span></span><span style="--0:#C6D0F5;--1:#4C4F69">}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">    </span></span><span style="--0:#C6D0F5;--1:#4C4F69">} </span><span style="--0:#949CBB;--0fs:italic;--1:#616373;--1fs:italic">//each row</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">  </span></span><span style="--0:#C6D0F5;--1:#4C4F69">} </span><span style="--0:#949CBB;--0fs:italic;--1:#616373;--1fs:italic">//each column</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C6D0F5;--1:#4C4F69">} </span><span style="--0:#949CBB;--0fs:italic;--1:#616373;--1fs:italic">//fill_top</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="fill_top(data: Data) {  for (x in 0 ... data.width) {    for (y in 0 ... data.height) {      if (get_cell(data, x, y) == 0) {        set_cell(data, x, y, rng.int(data.block_kinds) + 1)        var kind = rng.int(data.block_kinds) + 1        create_block(data, x, y, kind)        mark_busy(x, y, Busy.CREATE)      }    } //each row  } //each column} //fill_top"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h2"><h2 id="timing">Timing</h2><a class="sl-anchor-link" href="#timing"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œTimingâ€</span></a></div>
<p>Thereâ€™s one consideration we havenâ€™t had to think too much about: ordering of systems.</p>
<p>Which system goes first: <code dir="auto">Grid</code> or <code dir="auto">GridVisuals</code>? The answer isnâ€™t specified (â€œundefinedâ€).
We canâ€™t rely on it being one or the other, instead we want to be more intentional.</p>
<p>If the grid system sends the events first, and then grid visuals is initialized, it wonâ€™t respond in time to creating the grid.</p>
<p>Our system has a <code dir="auto">#phase</code> attribute which controls this.
We have a few tools for this, but we can also nudge things slightly using a number on the phase:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">system/grid.modifier.wren...System</span></figcaption><pre data-language="wren"><code><div class="ec-line"><div class="code"><span style="--0:#949CBB;--0fs:italic;--1:#616373;--1fs:italic">#system</span></div></div><div class="ec-line"><div class="code"><span style="--0:#949CBB;--0fs:italic;--1:#616373;--1fs:italic">#phase(on, tick</span><ins><span style="--0:#b0b6cd;--0fs:italic;--1:#4a4c58;--1fs:italic"> = 1</span></ins><span style="--0:#949CBB;--0fs:italic;--1:#616373;--1fs:italic">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#CA9EE6;--1:#8035E0">class</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">System</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#CA9EE6;--1:#8035E0">is</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Modifier</span><span style="--0:#C6D0F5;--1:#4C4F69"> {</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="#system#phase(on, tick = 1)class System is Modifier {"><div></div></button></div></figure></div>
<p>By adding <code dir="auto">= 1</code> here, it makes sure the grid will run after the visuals!</p>
<div class="sl-heading-wrapper level-h2"><h2 id="grid-visual-change">Grid Visual change</h2><a class="sl-anchor-link" href="#grid-visual-change"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œGrid Visual changeâ€</span></a></div>
<p>The event doesnâ€™t <em>have</em> to be handled by any particular system. The event is broadcast in anyone needs it.</p>
<div class="sl-heading-wrapper level-h3"><h3 id="connecting-to-a-wire">Connecting to a wire</h3><a class="sl-anchor-link" href="#connecting-to-a-wire"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œConnecting to a wireâ€</span></a></div>
<p>If we want to actually respond to it, weâ€™ll need to listen for that event on the wire and do something in response.</p>
<p>Like before, we start by importing the event types and while weâ€™re here, import <code dir="auto">Anim</code> as well:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">system/grid_visuals.modifier.wren</span></figcaption><pre data-language="wren"><code><div class="ec-line"><div class="code"><span style="--0:#CA9EE6;--1:#8035E0">import</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#A6D189;--1:#2D711E">"luxe: world"</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#CA9EE6;--1:#8035E0">for</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Anim</span></div></div><div class="ec-line"><div class="code"><span style="--0:#CA9EE6;--1:#8035E0">import</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#A6D189;--1:#2D711E">"system/grid.modifier"</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#CA9EE6;--1:#8035E0">for</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Grid</span><span style="--0:#C6D0F5;--1:#4C4F69">, </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">GridRow</span><span style="--0:#C6D0F5;--1:#4C4F69">, </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Busy</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--0:#cfa8e9;--1:#6429af">import</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#A6D189;--1:#235817">"system/grid_change.block"</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#cfa8e9;--1:#6429af">for</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">GridChange</span><span style="--0:#C6D0F5;--1:#474a62">, </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">GridChangeType</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="import &#x22;luxe: world&#x22; for Animimport &#x22;system/grid.modifier&#x22; for Grid, GridRow, Busyimport &#x22;system/grid_change.block&#x22; for GridChange, GridChangeType"><div></div></button></div></figure></div>
<p>Now, inside our <code dir="auto">System</code> init function, weâ€™ll connect to the Grid change wire:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">system/grid_visuals.modifier.wren...System</span></figcaption><pre data-language="wren"><code><div class="ec-line"><div class="code"><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">init</span><span style="--0:#C6D0F5;--1:#4C4F69">(world: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">World</span><span style="--0:#C6D0F5;--1:#4C4F69">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Log</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">print</span><span style="--0:#C6D0F5;--1:#4C4F69">(</span><span style="--0:#A6D189;--1:#2D711E">"init `%(</span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">This</span><span style="--0:#A6D189;--1:#2D711E">)` in world `%(</span><span style="--0:#C6D0F5;--1:#4C4F69">world</span><span style="--0:#A6D189;--1:#2D711E">)`"</span><span style="--0:#C6D0F5;--1:#4C4F69">)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">  </span></span><span style="--0:#C6D0F5;--1:#4C4F69">draw </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Draw</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">create</span><span style="--0:#C6D0F5;--1:#4C4F69">(</span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">World</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">render_set</span><span style="--0:#C6D0F5;--1:#4C4F69">(world))</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">  </span></span><span style="--0:#C6D0F5;--1:#4C4F69">style</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">color </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Color</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">black</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">  </span></span><span style="--0:#C6D0F5;--1:#4C4F69">style</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">thickness </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#EF9F76;--1:#AB4307">4</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">Grid</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">connect</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">change</span><span style="--0:#C6D0F5;--1:#474a62">(world) {</span><span style="--0:#eca4a7;--0fs:italic;--1:#8a2932;--1fs:italic">|entity: Entity, event: GridChange|</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">    </span><span style="--0:#cfa8e9;--1:#6429af">if</span><span style="--0:#C6D0F5;--1:#474a62">(event</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">change </span><span style="--0:#81C8BE;--1:#0d5458">==</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">GridChangeType</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">create) {</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">      </span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">create_block</span><span style="--0:#C6D0F5;--1:#474a62">(entity, event)</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">    </span></span><span style="--0:#C6D0F5">}</span></span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">  </span></span><span style="--0:#C6D0F5">} </span></span><span style="--0:#b0b6cd;--0fs:italic;--1:#4a4c58;--1fs:italic">// Grid.connect.change</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C6D0F5;--1:#4C4F69">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="init(world: World) {  Log.print(&#x22;init &#x60;%(This)&#x60; in world &#x60;%(world)&#x60;&#x22;)  draw = Draw.create(World.render_set(world))  style.color = Color.black  style.thickness = 4  Grid.connect.change(world) {|entity: Entity, event: GridChange|    if(event.change == GridChangeType.create) {      create_block(entity, event)    }  } // Grid.connect.change}"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h3"><h3 id="system-vs-entity">System vs entity</h3><a class="sl-anchor-link" href="#system-vs-entity"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œSystem vs entityâ€</span></a></div>
<p>Itâ€™s important to notice that the systems are communicating, and for a specific type, there is only one system per world.</p>
<p>All that means is that the system is the one listening,
not the individual entities! We receive an entity that the event relates to.</p>
<p>In our case, this is the grid, but if we had say, a row of grids,
or multiple match 3 grids around the world in space, weâ€™d still respond at the system level.</p>
<div class="sl-heading-wrapper level-h3"><h3 id="creating-blocks-as-sprites">Creating blocks as <code dir="auto">Sprite</code>s</h3><a class="sl-anchor-link" href="#creating-blocks-as-sprites"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œCreating blocks as Spritesâ€</span></a></div>
<p>We can cut the test code from <code dir="auto">game.wren</code> (removing it) that animated the Sprite and shape it to our needs.
Add this <code dir="auto">create_block</code> function to the <code dir="auto">System</code> class in our grid visuals system:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">system/grid_visuals.modifier.wren...System</span></figcaption><pre data-language="wren"><code><div class="ec-line"><div class="code"><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">create_block</span><span style="--0:#C6D0F5;--1:#4C4F69">(entity: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Entity</span><span style="--0:#C6D0F5;--1:#4C4F69">, event: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">GridChange</span><span style="--0:#C6D0F5;--1:#4C4F69">) {</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> data </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">get</span><span style="--0:#C6D0F5;--1:#4C4F69">(entity)</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> x </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> event</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">coord</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">x</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> y </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> event</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">coord</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">y</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> kind </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> event</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">kind</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> block </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Entity</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">create</span><span style="--0:#C6D0F5;--1:#4C4F69">(world, </span><span style="--0:#A6D189;--1:#2D711E">"grid-%(</span><span style="--0:#C6D0F5;--1:#4C4F69">x</span><span style="--0:#A6D189;--1:#2D711E">)-%(</span><span style="--0:#C6D0F5;--1:#4C4F69">y</span><span style="--0:#A6D189;--1:#2D711E">)"</span><span style="--0:#C6D0F5;--1:#4C4F69">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Anim</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">create</span><span style="--0:#C6D0F5;--1:#4C4F69">(block)</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Sprite</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">create</span><span style="--0:#C6D0F5;--1:#4C4F69">(block, </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Assets</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">image</span><span style="--0:#C6D0F5;--1:#4C4F69">(</span><span style="--0:#A6D189;--1:#2D711E">"image/%(</span><span style="--0:#C6D0F5;--1:#4C4F69">image_name</span><span style="--0:#A6D189;--1:#2D711E">)"</span><span style="--0:#C6D0F5;--1:#4C4F69">))</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Sprite</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">set_auto_size</span><span style="--0:#C6D0F5;--1:#4C4F69">(block, </span><span style="--0:#A6D189;--1:#2D711E">false</span><span style="--0:#C6D0F5;--1:#4C4F69">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Sprite</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">set_size</span><span style="--0:#C6D0F5;--1:#4C4F69">(block, data</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">block_width, data</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">block_height)</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Transform</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">create</span><span style="--0:#C6D0F5;--1:#4C4F69">(block)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> pos </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">grid_to_world</span><span style="--0:#C6D0F5;--1:#4C4F69">(data, x</span><span style="--0:#81C8BE;--1:#116E73">+</span><span style="--0:#EF9F76;--1:#AB4307">0.5</span><span style="--0:#C6D0F5;--1:#4C4F69">, y</span><span style="--0:#EF9F76;--1:#AB4307">-0.5</span><span style="--0:#C6D0F5;--1:#4C4F69">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Transform</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">set_pos</span><span style="--0:#C6D0F5;--1:#4C4F69">(block, pos</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">x, pos</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">y)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Sprite</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">animate</span><span style="--0:#C6D0F5;--1:#4C4F69">(block)</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">loop</span><span style="--0:#C6D0F5;--1:#4C4F69">()</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">grid</span><span style="--0:#C6D0F5;--1:#4C4F69">(</span><span style="--0:#EF9F76;--1:#AB4307">4</span><span style="--0:#C6D0F5;--1:#4C4F69">,</span><span style="--0:#EF9F76;--1:#AB4307">6</span><span style="--0:#C6D0F5;--1:#4C4F69">, </span><span style="--0:#EF9F76;--1:#AB4307">1</span><span style="--0:#C6D0F5;--1:#4C4F69">,</span><span style="--0:#EF9F76;--1:#AB4307">64</span><span style="--0:#C6D0F5;--1:#4C4F69">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">commit</span><span style="--0:#C6D0F5;--1:#4C4F69">()</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C6D0F5;--1:#4C4F69">} </span><span style="--0:#949CBB;--0fs:italic;--1:#616373;--1fs:italic">//create_block</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="create_block(entity: Entity, event: GridChange) {  var data = get(entity)  var x = event.coord.x  var y = event.coord.y  var kind = event.kind  var block = Entity.create(world, &#x22;grid-%(x)-%(y)&#x22;)  Anim.create(block)  Sprite.create(block, Assets.image(&#x22;image/%(image_name)&#x22;))  Sprite.set_auto_size(block, false)  Sprite.set_size(block, data.block_width, data.block_height)  Transform.create(block)  var pos = grid_to_world(data, x+0.5, y-0.5)  Transform.set_pos(block, pos.x, pos.y)  Sprite.animate(block)        .loop()        .grid(4,6, 1,64)        .commit()} //create_block"><div></div></button></div></figure></div>
<p>That should look something like this!</p>
<video preload="auto" autoplay controls muted playsinline loop style="max-width:100%; width:auto; margin:auto; display:block;"> <source src="/video/tutorials/match3/grid.sprites.mp4" type="video/mp4"> </video>
<div class="sl-heading-wrapper level-h3"><h3 id="tracking-and-cleaning-up">Tracking and cleaning up</h3><a class="sl-anchor-link" href="#tracking-and-cleaning-up"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œTracking and cleaning upâ€</span></a></div>
<p>If we donâ€™t clean up the entities we created, theyâ€™d stick around forever.
We need a way to track them so we can destroy them too.</p>
<p>Since this isnâ€™t user facing data and is temporary, we can store it in the <code dir="auto">System</code> class.
Weâ€™ll use the same kind of key we did before like <code dir="auto">blocks["%(x)-%(y)"]</code> to track them across the grid.</p>
<p>Since our <code dir="auto">System</code> is world level, and weâ€™re dealing with entities, weâ€™ll track these per entity.
Add a <code dir="auto">visuals</code> map to your <code dir="auto">System</code> class:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">system/grid_visuals.modifier.wren...System</span></figcaption><pre data-language="wren"><code><div class="ec-line"><div class="code"><span style="--0:#CA9EE6;--1:#8035E0">class</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">System</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#CA9EE6;--1:#8035E0">is</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Modifier</span><span style="--0:#C6D0F5;--1:#4C4F69"> {</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#81C8BE;--1:#116E73">...</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> visuals: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Map</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> {}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="class System is Modifier {  ...  var visuals: Map = {}"><div></div></button></div></figure></div>
<p>Inside <code dir="auto">attach</code> we can initialize the blocks map for the entity.
This is a map of blocks for each grid visual modifier instance!</p>
<p>In <code dir="auto">detach</code>, we clear the visuals associated with the entity:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">system/grid_visuals.modifier.wren...System</span></figcaption><pre data-language="wren"><code><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">attach</span><span style="--0:#C6D0F5;--1:#4C4F69">(entity: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Entity</span><span style="--0:#C6D0F5;--1:#4C4F69">, data: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Data</span><span style="--0:#C6D0F5;--1:#4C4F69">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Log</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">print</span><span style="--0:#C6D0F5;--1:#4C4F69">(</span><span style="--0:#A6D189;--1:#2D711E">"attached to `%(</span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Entity</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">name</span><span style="--0:#A6D189;--1:#2D711E">(</span><span style="--0:#C6D0F5;--1:#4C4F69">entity</span><span style="--0:#A6D189;--1:#2D711E">))` `%(</span><span style="--0:#C6D0F5;--1:#4C4F69">entity</span><span style="--0:#A6D189;--1:#2D711E">)` - `%(</span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">This</span><span style="--0:#A6D189;--1:#2D711E">)`"</span><span style="--0:#C6D0F5;--1:#4C4F69">)</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">    </span></span><span style="--0:#C6D0F5">visuals[entity] </span></span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> {}</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">  </span></span><span style="--0:#C6D0F5;--1:#4C4F69">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">detach</span><span style="--0:#C6D0F5;--1:#4C4F69">(entity: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Entity</span><span style="--0:#C6D0F5;--1:#4C4F69">, data: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Data</span><span style="--0:#C6D0F5;--1:#4C4F69">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Log</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">print</span><span style="--0:#C6D0F5;--1:#4C4F69">(</span><span style="--0:#A6D189;--1:#2D711E">"detached from `%(</span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Entity</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">name</span><span style="--0:#A6D189;--1:#2D711E">(</span><span style="--0:#C6D0F5;--1:#4C4F69">entity</span><span style="--0:#A6D189;--1:#2D711E">))` `%(</span><span style="--0:#C6D0F5;--1:#4C4F69">entity</span><span style="--0:#A6D189;--1:#2D711E">)` - `%(</span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">This</span><span style="--0:#A6D189;--1:#2D711E">)`"</span><span style="--0:#C6D0F5;--1:#4C4F69">)</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">    </span><span style="--0:#cfa8e9;--1:#6429af">var</span><span style="--0:#C6D0F5;--1:#474a62"> blocks </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> visuals</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">remove</span><span style="--0:#C6D0F5;--1:#474a62">(entity)</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">    </span></span><span style="--0:#C6D0F5">blocks</span></span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">values</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">each {</span><span style="--0:#eca4a7;--0fs:italic;--1:#8a2932;--1fs:italic">|block: Entity|</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">      </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">Entity</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">destroy</span><span style="--0:#C6D0F5;--1:#474a62">(block)</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">    </span></span><span style="--0:#C6D0F5">}</span></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">  </span></span><span style="--0:#C6D0F5;--1:#4C4F69">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="  attach(entity: Entity, data: Data) {    Log.print(&#x22;attached to &#x60;%(Entity.name(entity))&#x60; &#x60;%(entity)&#x60; - &#x60;%(This)&#x60;&#x22;)    visuals[entity] = {}  }  detach(entity: Entity, data: Data) {    Log.print(&#x22;detached from &#x60;%(Entity.name(entity))&#x60; &#x60;%(entity)&#x60; - &#x60;%(This)&#x60;&#x22;)    var blocks = visuals.remove(entity)    blocks.values.each {|block: Entity|      Entity.destroy(block)    }  }"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h3"><h3 id="shapes">Shapes</h3><a class="sl-anchor-link" href="#shapes"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œShapesâ€</span></a></div>
<p>Since weâ€™d like the shape kinds to not all be a star, weâ€™d also change <code dir="auto">create_block</code> to use a different image for each shape kind.
To do that weâ€™ll make an array in <code dir="auto">System</code>, just like we had one for <code dir="auto">sides</code> before:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">system/grid_visuals.modifier.wren...System</span></figcaption><pre data-language="wren"><code><div class="ec-line highlight ins"><div class="code"><span style="--0:#cfa8e9;--1:#6429af">var</span><span style="--0:#C6D0F5;--1:#474a62"> shapes </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> [</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#A6D189;--1:#235817">"circle"</span><span style="--0:#C6D0F5;--1:#474a62">,</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#A6D189;--1:#235817">"triangle"</span><span style="--0:#C6D0F5;--1:#474a62">,</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#A6D189;--1:#235817">"square"</span><span style="--0:#C6D0F5;--1:#474a62">,</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#A6D189;--1:#235817">"pentagon"</span><span style="--0:#C6D0F5;--1:#474a62">,</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#A6D189;--1:#235817">"hexagon"</span><span style="--0:#C6D0F5;--1:#474a62">,</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#A6D189;--1:#235817">"star"</span><span style="--0:#C6D0F5;--1:#474a62">,</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--0:#C6D0F5;--1:#474a62">]</span></div></div><div class="ec-line"><div class="code"><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> sides </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> [</span><span style="--0:#EF9F76;--1:#AB4307">32</span><span style="--0:#C6D0F5;--1:#4C4F69">, </span><span style="--0:#EF9F76;--1:#AB4307">3</span><span style="--0:#C6D0F5;--1:#4C4F69">, </span><span style="--0:#EF9F76;--1:#AB4307">4</span><span style="--0:#C6D0F5;--1:#4C4F69">, </span><span style="--0:#EF9F76;--1:#AB4307">5</span><span style="--0:#C6D0F5;--1:#4C4F69">, </span><span style="--0:#EF9F76;--1:#AB4307">6</span><span style="--0:#C6D0F5;--1:#4C4F69">, </span><span style="--0:#EF9F76;--1:#AB4307">32</span><span style="--0:#C6D0F5;--1:#4C4F69">]</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="var shapes = [  &#x22;circle&#x22;,  &#x22;triangle&#x22;,  &#x22;square&#x22;,  &#x22;pentagon&#x22;,  &#x22;hexagon&#x22;,  &#x22;star&#x22;,]var sides = [32, 3, 4, 5, 6, 32]"><div></div></button></div></figure></div>
<p>Now we can use that in <code dir="auto">create_block</code>, and also store the entity we create in the visuals map.</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">system/grid_visuals.modifier.wren...System</span></figcaption><pre data-language="wren"><code><div class="ec-line"><div class="code"><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">create_block</span><span style="--0:#C6D0F5;--1:#4C4F69">(entity: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Entity</span><span style="--0:#C6D0F5;--1:#4C4F69">, event: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">GridChange</span><span style="--0:#C6D0F5;--1:#4C4F69">) {</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> data </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">get</span><span style="--0:#C6D0F5;--1:#4C4F69">(entity)</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> x </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> event</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">coord</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">x</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> y </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> event</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">coord</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">y</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> kind </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> event</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">kind</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#cfa8e9;--1:#6429af">var</span><span style="--0:#C6D0F5;--1:#474a62"> blocks </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> visuals[entity]</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#cfa8e9;--1:#6429af">var</span><span style="--0:#C6D0F5;--1:#474a62"> image_name </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> shapes[kind </span><span style="--0:#81C8BE;--1:#0d5458">-</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#f0a57f;--1:#833305">1</span><span style="--0:#C6D0F5;--1:#474a62">]</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> block </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Entity</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">create</span><span style="--0:#C6D0F5;--1:#4C4F69">(world, </span><span style="--0:#A6D189;--1:#2D711E">"grid-%(</span><span style="--0:#C6D0F5;--1:#4C4F69">x</span><span style="--0:#A6D189;--1:#2D711E">)-%(</span><span style="--0:#C6D0F5;--1:#4C4F69">y</span><span style="--0:#A6D189;--1:#2D711E">)"</span><span style="--0:#C6D0F5;--1:#4C4F69">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Anim</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">create</span><span style="--0:#C6D0F5;--1:#4C4F69">(block)</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">Sprite</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">create</span><span style="--0:#C6D0F5;--1:#474a62">(block, </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">Assets</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">image</span><span style="--0:#C6D0F5;--1:#474a62">(</span><span style="--0:#A6D189;--1:#235817">"image/</span><ins><span style="--0:#A6D189;--1:#1e4c14">%(</span><span style="--0:#C6D0F5;--1:#3e4055">image_name</span><span style="--0:#A6D189;--1:#1e4c14">)</span></ins><span style="--0:#A6D189;--1:#235817">"</span><span style="--0:#C6D0F5;--1:#474a62">))</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Sprite</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">set_auto_size</span><span style="--0:#C6D0F5;--1:#4C4F69">(block, </span><span style="--0:#A6D189;--1:#2D711E">false</span><span style="--0:#C6D0F5;--1:#4C4F69">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Sprite</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">set_size</span><span style="--0:#C6D0F5;--1:#4C4F69">(block, data</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">block_width, data</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">block_height)</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Transform</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">create</span><span style="--0:#C6D0F5;--1:#4C4F69">(block)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> pos </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">grid_to_world</span><span style="--0:#C6D0F5;--1:#4C4F69">(data, x</span><span style="--0:#81C8BE;--1:#116E73">+</span><span style="--0:#EF9F76;--1:#AB4307">0.5</span><span style="--0:#C6D0F5;--1:#4C4F69">, y</span><span style="--0:#EF9F76;--1:#AB4307">-0.5</span><span style="--0:#C6D0F5;--1:#4C4F69">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Transform</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">set_pos</span><span style="--0:#C6D0F5;--1:#4C4F69">(block, pos</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">x, pos</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">y)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Sprite</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">animate</span><span style="--0:#C6D0F5;--1:#4C4F69">(block)</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">loop</span><span style="--0:#C6D0F5;--1:#4C4F69">()</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">grid</span><span style="--0:#C6D0F5;--1:#4C4F69">(</span><span style="--0:#EF9F76;--1:#AB4307">4</span><span style="--0:#C6D0F5;--1:#4C4F69">,</span><span style="--0:#EF9F76;--1:#AB4307">6</span><span style="--0:#C6D0F5;--1:#4C4F69">, </span><span style="--0:#EF9F76;--1:#AB4307">1</span><span style="--0:#C6D0F5;--1:#4C4F69">,</span><span style="--0:#EF9F76;--1:#AB4307">64</span><span style="--0:#C6D0F5;--1:#4C4F69">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">commit</span><span style="--0:#C6D0F5;--1:#4C4F69">()</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">  </span></span><span style="--0:#C6D0F5">blocks[</span></span><span style="--0:#A6D189;--1:#235817">"%(</span><span style="--0:#C6D0F5;--1:#474a62">x</span><span style="--0:#A6D189;--1:#235817">)-%(</span><span style="--0:#C6D0F5;--1:#474a62">y</span><span style="--0:#A6D189;--1:#235817">)"</span><span style="--0:#C6D0F5;--1:#474a62">] </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> block</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C6D0F5;--1:#4C4F69">} </span><span style="--0:#949CBB;--0fs:italic;--1:#616373;--1fs:italic">//create_block</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="create_block(entity: Entity, event: GridChange) {  var data = get(entity)  var x = event.coord.x  var y = event.coord.y  var kind = event.kind  var blocks = visuals[entity]  var image_name = shapes[kind - 1]  var block = Entity.create(world, &#x22;grid-%(x)-%(y)&#x22;)  Anim.create(block)  Sprite.create(block, Assets.image(&#x22;image/%(image_name)&#x22;))  Sprite.set_auto_size(block, false)  Sprite.set_size(block, data.block_width, data.block_height)  Transform.create(block)  var pos = grid_to_world(data, x+0.5, y-0.5)  Transform.set_pos(block, pos.x, pos.y)  Sprite.animate(block)        .loop()        .grid(4,6, 1,64)        .commit()  blocks[&#x22;%(x)-%(y)&#x22;] = block} //create_block"><div></div></button></div></figure></div>
<p>And just like that! We can see the shapes match the <code dir="auto">Draw</code> versions.</p>
<video preload="auto" autoplay controls muted playsinline loop style="max-width:100%; width:auto; margin:auto; display:block;"> <source src="/video/tutorials/match3/grid.sprites.1.mp4" type="video/mp4"> </video>
<div class="sl-heading-wrapper level-h3"><h3 id="single-frame-animation">Single frame animation</h3><a class="sl-anchor-link" href="#single-frame-animation"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œSingle frame animationâ€</span></a></div>
<p>While it is neat to see our animation working, having all the blocks animating at all times can be a bit much.</p>
<p>Instead weâ€™d like to just set it to the first frame of the animation, so it shows a static image of the block.</p>
<p>We can do that using the <code dir="auto">Sprite.set_uv</code> function. This function takes a rectangle in 0â€¦1 range.
Since our grid is 4x6, we can use 1/4 and 1/6 to get the value we want:</p>
<p>Inside <code dir="auto">create_block</code> change it to this:</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="wren"><code><div class="ec-line highlight del"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#68430e;--1fs:italic">Sprite</span><span style="--0:#81C8BE;--1:#0d5356">.</span><span style="--0:#99b4f0;--0fs:italic;--1:#1444a4;--1fs:italic">animate</span><span style="--0:#C6D0F5;--1:#45485f">(block)</span></div></div><div class="ec-line highlight del"><div class="code"><span class="indent">        </span><span style="--0:#81C8BE;--1:#0d5356">.</span><span style="--0:#99b4f0;--0fs:italic;--1:#1444a4;--1fs:italic">loop</span><span style="--0:#C6D0F5;--1:#45485f">()</span></div></div><div class="ec-line highlight del"><div class="code"><span class="indent">        </span><span style="--0:#81C8BE;--1:#0d5356">.</span><span style="--0:#99b4f0;--0fs:italic;--1:#1444a4;--1fs:italic">grid</span><span style="--0:#C6D0F5;--1:#45485f">(</span><span style="--0:#f0a27a;--1:#803205">4</span><span style="--0:#C6D0F5;--1:#45485f">,</span><span style="--0:#f0a27a;--1:#803205">6</span><span style="--0:#C6D0F5;--1:#45485f">, </span><span style="--0:#f0a27a;--1:#803205">1</span><span style="--0:#C6D0F5;--1:#45485f">,</span><span style="--0:#f0a27a;--1:#803205">24</span><span style="--0:#C6D0F5;--1:#45485f">)</span></div></div><div class="ec-line highlight del"><div class="code"><span class="indent">        </span><span style="--0:#81C8BE;--1:#0d5356">.</span><span style="--0:#99b4f0;--0fs:italic;--1:#1444a4;--1fs:italic">commit</span><span style="--0:#C6D0F5;--1:#45485f">()</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line highlight ins"><div class="code"><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">Sprite</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">set_uv</span><span style="--0:#C6D0F5;--1:#474a62">(block, </span><span style="--0:#f0a57f;--1:#833305">0</span><span style="--0:#C6D0F5;--1:#474a62">, </span><span style="--0:#f0a57f;--1:#833305">0</span><span style="--0:#C6D0F5;--1:#474a62">, </span><span style="--0:#f0a57f;--1:#833305">1</span><span style="--0:#81C8BE;--1:#0d5458">/</span><span style="--0:#f0a57f;--1:#833305">4</span><span style="--0:#C6D0F5;--1:#474a62">, </span><span style="--0:#f0a57f;--1:#833305">1</span><span style="--0:#81C8BE;--1:#0d5458">/</span><span style="--0:#f0a57f;--1:#833305">6</span><span style="--0:#C6D0F5;--1:#474a62">)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="  Sprite.animate(block)        .loop()        .grid(4,6, 1,24)        .commit()Sprite.set_uv(block, 0, 0, 1/4, 1/6)"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h2"><h2 id="other-grid-events">Other grid events</h2><a class="sl-anchor-link" href="#other-grid-events"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œOther grid eventsâ€</span></a></div>
<p>Weâ€™ll need to handle the <code dir="auto">destroy</code> and <code dir="auto">swap</code> events so our sprites can respond to them.</p>
<p>Add two more cases in the <code dir="auto">init</code> function:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">system/grid_visuals.modifier.wren...System</span></figcaption><pre data-language="wren"><code><div class="ec-line"><div class="code"><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Grid</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">connect</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">change</span><span style="--0:#C6D0F5;--1:#4C4F69">(world) {</span><span style="--0:#EA999C;--0fs:italic;--1:#B43641;--1fs:italic">|entity: Entity, event: GridChange|</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">if</span><span style="--0:#C6D0F5;--1:#4C4F69">(event</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">change </span><span style="--0:#81C8BE;--1:#116E73">==</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">GridChangeType</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">create) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">create_block</span><span style="--0:#C6D0F5;--1:#4C4F69">(entity, event)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">  </span></span><span style="--0:#C6D0F5;--1:#4C4F69">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#cfa8e9;--1:#6429af">if</span><span style="--0:#C6D0F5;--1:#474a62">(event</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">change </span><span style="--0:#81C8BE;--1:#0d5458">==</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">GridChangeType</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">destroy) {</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">    </span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">destroy_block</span><span style="--0:#C6D0F5;--1:#474a62">(entity, event)</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">  </span></span><span style="--0:#C6D0F5">}</span></span></div></div><div class="ec-line highlight ins"><div class="code">
</div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#cfa8e9;--1:#6429af">if</span><span style="--0:#C6D0F5;--1:#474a62">(event</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">change </span><span style="--0:#81C8BE;--1:#0d5458">==</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">GridChangeType</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">swap) {</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">    </span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">swap_block</span><span style="--0:#C6D0F5;--1:#474a62">(entity, event)</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">  </span></span><span style="--0:#C6D0F5">}</span></span></div></div><div class="ec-line"><div class="code"><span style="--0:#C6D0F5;--1:#4C4F69">} </span><span style="--0:#949CBB;--0fs:italic;--1:#616373;--1fs:italic">//Grid.connect.change</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="Grid.connect.change(world) {|entity: Entity, event: GridChange|  if(event.change == GridChangeType.create) {    create_block(entity, event)  }  if(event.change == GridChangeType.destroy) {    destroy_block(entity, event)  }  if(event.change == GridChangeType.swap) {    swap_block(entity, event)  }} //Grid.connect.change"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h3"><h3 id="visuals-block-destroy-event">Visuals: block destroy event</h3><a class="sl-anchor-link" href="#visuals-block-destroy-event"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œVisuals: block destroy eventâ€</span></a></div>
<p>In our visuals system class we can add a function to handle destroying a block.
Our <code dir="auto">GridChange</code> event has a <code dir="auto">start</code> flag, to tell us whether this is the start or end of a task.
Weâ€™ll use that to animate the sprite spinning on the way out, and then destroy the entity when done.</p>
<p>We also use <code dir="auto">rate</code> to speed up the animation, we run it 4x faster so we get a chance to see it (weâ€™ll tweak timings later).</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">system/grid_visuals.modifier.wren...System</span></figcaption><pre data-language="wren"><code><div class="ec-line"><div class="code"><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">destroy_block</span><span style="--0:#C6D0F5;--1:#4C4F69">(entity: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Entity</span><span style="--0:#C6D0F5;--1:#4C4F69">, event: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">GridChange</span><span style="--0:#C6D0F5;--1:#4C4F69">) {</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> blocks </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> visuals[entity]</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> key </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#A6D189;--1:#2D711E">"%(</span><span style="--0:#C6D0F5;--1:#4C4F69">event</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#A6D189;--1:#2D711E">coord</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#A6D189;--1:#2D711E">x)-%(</span><span style="--0:#C6D0F5;--1:#4C4F69">event</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#A6D189;--1:#2D711E">coord</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#A6D189;--1:#2D711E">y)"</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> block </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> blocks[key]</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">if</span><span style="--0:#C6D0F5;--1:#4C4F69">(event</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">start) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Sprite</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">animate</span><span style="--0:#C6D0F5;--1:#4C4F69">(block)</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">loop</span><span style="--0:#C6D0F5;--1:#4C4F69">()</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">rate</span><span style="--0:#C6D0F5;--1:#4C4F69">(</span><span style="--0:#EF9F76;--1:#AB4307">4</span><span style="--0:#C6D0F5;--1:#4C4F69">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">grid</span><span style="--0:#C6D0F5;--1:#4C4F69">(</span><span style="--0:#EF9F76;--1:#AB4307">4</span><span style="--0:#C6D0F5;--1:#4C4F69">,</span><span style="--0:#EF9F76;--1:#AB4307">6</span><span style="--0:#C6D0F5;--1:#4C4F69">, </span><span style="--0:#EF9F76;--1:#AB4307">1</span><span style="--0:#C6D0F5;--1:#4C4F69">,</span><span style="--0:#EF9F76;--1:#AB4307">24</span><span style="--0:#C6D0F5;--1:#4C4F69">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">commit</span><span style="--0:#C6D0F5;--1:#4C4F69">()</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">  </span></span><span style="--0:#C6D0F5;--1:#4C4F69">} </span><span style="--0:#CA9EE6;--1:#8035E0">else</span><span style="--0:#C6D0F5;--1:#4C4F69"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">    </span></span><span style="--0:#C6D0F5;--1:#4C4F69">blocks</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">remove</span><span style="--0:#C6D0F5;--1:#4C4F69">(key)</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Entity</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">destroy</span><span style="--0:#C6D0F5;--1:#4C4F69">(block)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">  </span></span><span style="--0:#C6D0F5;--1:#4C4F69">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C6D0F5;--1:#4C4F69">} </span><span style="--0:#949CBB;--0fs:italic;--1:#616373;--1fs:italic">//destroy_block</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="destroy_block(entity: Entity, event: GridChange) {  var blocks = visuals[entity]  var key = &#x22;%(event.coord.x)-%(event.coord.y)&#x22;  var block = blocks[key]  if(event.start) {    Sprite.animate(block)          .loop()          .rate(4)          .grid(4,6, 1,24)          .commit()  } else {    blocks.remove(key)    Entity.destroy(block)  }} //destroy_block"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h3"><h3 id="visuals-block-swap-event">Visuals: block swap event</h3><a class="sl-anchor-link" href="#visuals-block-swap-event"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œVisuals: block swap eventâ€</span></a></div>
<p>Our goal:</p>
<ul>
<li>While a swap takes place, animate the tiles doing a flip (our animation!)</li>
<li>Keep the visual representation of the grid matching the logical one</li>
</ul>
<p>Since weâ€™re tracking blocks by a key that includes their location, when a swap takes place
we have to update our blocks map to match. This is a literal swap! <strong>We tell the entity that is now lives at a new home.</strong></p>
<p>We also use <code dir="auto">Sprite.animate</code> once again to <strong>play an animation</strong>.
This time we use <code dir="auto">count(num: Num)</code> instead of <code dir="auto">loop()</code> because we only want the animation
to play through once. When an animation ends, itâ€™ll leave the sprite on the end frame, which works for us!</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">system/grid_visuals.modifier.wren...System</span></figcaption><pre data-language="wren"><code><div class="ec-line"><div class="code"><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">swap_block</span><span style="--0:#C6D0F5;--1:#4C4F69">(entity: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Entity</span><span style="--0:#C6D0F5;--1:#4C4F69">, event: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">GridChange</span><span style="--0:#C6D0F5;--1:#4C4F69">) {</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> data </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">get</span><span style="--0:#C6D0F5;--1:#4C4F69">(entity)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> blocks </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> visuals[entity]</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> key1 </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#A6D189;--1:#2D711E">"%(</span><span style="--0:#C6D0F5;--1:#4C4F69">event</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#A6D189;--1:#2D711E">coord</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#A6D189;--1:#2D711E">x)-%(</span><span style="--0:#C6D0F5;--1:#4C4F69">event</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#A6D189;--1:#2D711E">coord</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#A6D189;--1:#2D711E">y)"</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> key2 </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#A6D189;--1:#2D711E">"%(</span><span style="--0:#C6D0F5;--1:#4C4F69">event</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#A6D189;--1:#2D711E">other</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#A6D189;--1:#2D711E">x)-%(</span><span style="--0:#C6D0F5;--1:#4C4F69">event</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#A6D189;--1:#2D711E">other</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#A6D189;--1:#2D711E">y)"</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> block1 </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> blocks[key1]</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> block2 </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> blocks[key2]</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">if</span><span style="--0:#C6D0F5;--1:#4C4F69">(event</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">start) {</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#CA9EE6;--1:#8035E0">if</span><span style="--0:#C6D0F5;--1:#4C4F69">(</span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Entity</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">valid</span><span style="--0:#C6D0F5;--1:#4C4F69">(block1)) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Sprite</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">animate</span><span style="--0:#C6D0F5;--1:#4C4F69">(block1)</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">count</span><span style="--0:#C6D0F5;--1:#4C4F69">(</span><span style="--0:#EF9F76;--1:#AB4307">1</span><span style="--0:#C6D0F5;--1:#4C4F69">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">rate</span><span style="--0:#C6D0F5;--1:#4C4F69">(</span><span style="--0:#EF9F76;--1:#AB4307">2</span><span style="--0:#C6D0F5;--1:#4C4F69">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">grid</span><span style="--0:#C6D0F5;--1:#4C4F69">(</span><span style="--0:#EF9F76;--1:#AB4307">4</span><span style="--0:#C6D0F5;--1:#4C4F69">,</span><span style="--0:#EF9F76;--1:#AB4307">6</span><span style="--0:#C6D0F5;--1:#4C4F69">, </span><span style="--0:#EF9F76;--1:#AB4307">1</span><span style="--0:#C6D0F5;--1:#4C4F69">,</span><span style="--0:#EF9F76;--1:#AB4307">24</span><span style="--0:#C6D0F5;--1:#4C4F69">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">commit</span><span style="--0:#C6D0F5;--1:#4C4F69">()</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">    </span></span><span style="--0:#C6D0F5;--1:#4C4F69">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#CA9EE6;--1:#8035E0">if</span><span style="--0:#C6D0F5;--1:#4C4F69">(</span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Entity</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">valid</span><span style="--0:#C6D0F5;--1:#4C4F69">(block2)) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Sprite</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">animate</span><span style="--0:#C6D0F5;--1:#4C4F69">(block2)</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">count</span><span style="--0:#C6D0F5;--1:#4C4F69">(</span><span style="--0:#EF9F76;--1:#AB4307">1</span><span style="--0:#C6D0F5;--1:#4C4F69">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">rate</span><span style="--0:#C6D0F5;--1:#4C4F69">(</span><span style="--0:#EF9F76;--1:#AB4307">2</span><span style="--0:#C6D0F5;--1:#4C4F69">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">grid</span><span style="--0:#C6D0F5;--1:#4C4F69">(</span><span style="--0:#EF9F76;--1:#AB4307">4</span><span style="--0:#C6D0F5;--1:#4C4F69">,</span><span style="--0:#EF9F76;--1:#AB4307">6</span><span style="--0:#C6D0F5;--1:#4C4F69">, </span><span style="--0:#EF9F76;--1:#AB4307">1</span><span style="--0:#C6D0F5;--1:#4C4F69">,</span><span style="--0:#EF9F76;--1:#AB4307">24</span><span style="--0:#C6D0F5;--1:#4C4F69">)</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">commit</span><span style="--0:#C6D0F5;--1:#4C4F69">()</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">    </span></span><span style="--0:#C6D0F5;--1:#4C4F69">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#CA9EE6;--1:#8035E0">return</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">  </span></span><span style="--0:#C6D0F5;--1:#4C4F69">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#949CBB;--0fs:italic;--1:#616373;--1fs:italic">//since our logical grid has changed underneath us, swap the visual block references</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">  </span></span><span style="--0:#C6D0F5;--1:#4C4F69">blocks[key2] </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> block1</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">  </span></span><span style="--0:#C6D0F5;--1:#4C4F69">blocks[key1] </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> block2</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C6D0F5;--1:#4C4F69">} </span><span style="--0:#949CBB;--0fs:italic;--1:#616373;--1fs:italic">//swap_block</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="swap_block(entity: Entity, event: GridChange) {  var data = get(entity)  var blocks = visuals[entity]  var key1 = &#x22;%(event.coord.x)-%(event.coord.y)&#x22;  var key2 = &#x22;%(event.other.x)-%(event.other.y)&#x22;  var block1 = blocks[key1]  var block2 = blocks[key2]  if(event.start) {    if(Entity.valid(block1)) {      Sprite.animate(block1)          .count(1)          .rate(2)          .grid(4,6, 1,24)          .commit()    }    if(Entity.valid(block2)) {      Sprite.animate(block2)          .count(1)          .rate(2)          .grid(4,6, 1,24)          .commit()    }    return  }  //since our logical grid has changed underneath us, swap the visual block references  blocks[key2] = block1  blocks[key1] = block2} //swap_block"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h3"><h3 id="visuals-block-positions">Visuals: block positions</h3><a class="sl-anchor-link" href="#visuals-block-positions"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œVisuals: block positionsâ€</span></a></div>
<p>We have one more place to update our visuals: the tick function that handled Busy tasks.
Since our code already works here to move things around, we can use it to move our sprites around as well.</p>
<p>Inside our <code dir="auto">tick</code> function, inside the grid loop, we can add a few lines just before it draws the shape to update the position,
and weâ€™ll update the scale as well.</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">system/grid_visuals.modifier.wren...System</span></figcaption><pre data-language="wren"><code><div class="ec-line"><div class="code"><span style="--0:#81C8BE;--1:#116E73">...</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line highlight ins"><div class="code"><span style="--0:#cfa8e9;--1:#6429af">var</span><span style="--0:#C6D0F5;--1:#474a62"> block: </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">Entity</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> blocks[</span><span style="--0:#A6D189;--1:#235817">"%(</span><span style="--0:#C6D0F5;--1:#474a62">x</span><span style="--0:#A6D189;--1:#235817">)-%(</span><span style="--0:#C6D0F5;--1:#474a62">y</span><span style="--0:#A6D189;--1:#235817">)"</span><span style="--0:#C6D0F5;--1:#474a62">]</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--0:#cfa8e9;--1:#6429af">if</span><span style="--0:#C6D0F5;--1:#474a62">(</span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">Entity</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">valid</span><span style="--0:#C6D0F5;--1:#474a62">(block)) {</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">Transform</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">set_pos</span><span style="--0:#C6D0F5;--1:#474a62">(block, pos</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">x </span><span style="--0:#81C8BE;--1:#0d5458">+</span><span style="--0:#C6D0F5;--1:#474a62"> half_width, pos</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">y </span><span style="--0:#81C8BE;--1:#0d5458">+</span><span style="--0:#C6D0F5;--1:#474a62"> half_width)</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">Transform</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">set_scale</span><span style="--0:#C6D0F5;--1:#474a62">(block, scale, scale)</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--0:#C6D0F5;--1:#474a62">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Draw</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">ngon_solid</span><span style="--0:#C6D0F5;--1:#4C4F69">(draw, pos</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">x </span><span style="--0:#81C8BE;--1:#116E73">+</span><span style="--0:#C6D0F5;--1:#4C4F69"> half_width, pos</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">y </span><span style="--0:#81C8BE;--1:#116E73">+</span><span style="--0:#C6D0F5;--1:#4C4F69"> half_height, depth, radius_x, radius_y, sides, </span><span style="--0:#EF9F76;--1:#AB4307">90</span><span style="--0:#C6D0F5;--1:#4C4F69">, color)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="...var block: Entity = blocks[&#x22;%(x)-%(y)&#x22;]if(Entity.valid(block)) {  Transform.set_pos(block, pos.x + half_width, pos.y + half_width)  Transform.set_scale(block, scale, scale)}Draw.ngon_solid(draw, pos.x + half_width, pos.y + half_height, depth, radius_x, radius_y, sides, 90, color)"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h2"><h2 id="grid-send-the-other-events">Grid: send the other events</h2><a class="sl-anchor-link" href="#grid-send-the-other-events"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œGrid: send the other eventsâ€</span></a></div>
<p>The last piece of the puzzle is updating the <code dir="auto">Grid</code> system to send the destroy and swap events.
Switch back to the <code dir="auto">grid.modifier.wren</code> to finish that!</p>
<div class="sl-heading-wrapper level-h3"><h3 id="destroy-event-start">Destroy event start</h3><a class="sl-anchor-link" href="#destroy-event-start"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œDestroy event startâ€</span></a></div>
<p>Inside process matches, when weâ€™ve found a match, we send the destroy start event:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">system/grid.modifier.wren...System</span></figcaption><pre data-language="wren"><code><div class="ec-line"><div class="code"><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">process_matches</span><span style="--0:#C6D0F5;--1:#4C4F69">(data: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Data</span><span style="--0:#C6D0F5;--1:#4C4F69">) {</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> matches </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">find_all_matches</span><span style="--0:#C6D0F5;--1:#4C4F69">(data)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">  </span></span><span style="--0:#C6D0F5;--1:#4C4F69">fiber </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Fiber</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#CA9EE6;--1:#8035E0">new</span><span style="--0:#C6D0F5;--1:#4C4F69"> {</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#CA9EE6;--1:#8035E0">while</span><span style="--0:#C6D0F5;--1:#4C4F69">(matches</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">count </span><span style="--0:#81C8BE;--1:#116E73">></span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#EF9F76;--1:#AB4307">0</span><span style="--0:#C6D0F5;--1:#4C4F69">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#CA9EE6;--1:#8035E0">for</span><span style="--0:#C6D0F5;--1:#4C4F69">(match </span><span style="--0:#CA9EE6;--1:#8035E0">in</span><span style="--0:#C6D0F5;--1:#4C4F69"> matches) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> x </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> match[</span><span style="--0:#EF9F76;--1:#AB4307">0</span><span style="--0:#C6D0F5;--1:#4C4F69">]</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> y </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> match[</span><span style="--0:#EF9F76;--1:#AB4307">1</span><span style="--0:#C6D0F5;--1:#4C4F69">]</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> busy </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">mark_busy</span><span style="--0:#C6D0F5;--1:#4C4F69">(x, y, </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">DESTROY)</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">        </span><span style="--0:#cfa8e9;--1:#6429af">var</span><span style="--0:#C6D0F5;--1:#474a62"> event: </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">GridChange</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> change</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">prepare</span><span style="--0:#C6D0F5;--1:#474a62">()</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">            </span></span><span style="--0:#C6D0F5">event</span></span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">coord </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> [x, y]</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">            </span></span><span style="--0:#C6D0F5">event</span></span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">change </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">GridChangeType</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">destroy</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">            </span></span><span style="--0:#C6D0F5">event</span></span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">start </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#A6D189;--1:#235817">true</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">        </span></span><span style="--0:#C6D0F5">change</span></span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">send</span><span style="--0:#C6D0F5;--1:#474a62">(data</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">entity, event)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">      </span></span><span style="--0:#C6D0F5;--1:#4C4F69">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="process_matches(data: Data) {  var matches = find_all_matches(data)  fiber = Fiber.new {    while(matches.count > 0) {      for(match in matches) {        var x = match[0]        var y = match[1]        var busy = mark_busy(x, y, Busy.DESTROY)        var event: GridChange = change.prepare()            event.coord = [x, y]            event.change = GridChangeType.destroy            event.start = true        change.send(data.entity, event)      }"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h3"><h3 id="destroy-event-end">Destroy event end</h3><a class="sl-anchor-link" href="#destroy-event-end"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œDestroy event endâ€</span></a></div>
<p>Near our <code dir="auto">create_block</code> we can add <code dir="auto">destroy_block</code>.
Itâ€™s gonna be pretty similar:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">system/grid.modifier.wren...System</span></figcaption><pre data-language="wren"><code><div class="ec-line"><div class="code"><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">destroy_block</span><span style="--0:#C6D0F5;--1:#4C4F69">(data: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Data</span><span style="--0:#C6D0F5;--1:#4C4F69">, x: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Num</span><span style="--0:#C6D0F5;--1:#4C4F69">, y: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Num</span><span style="--0:#C6D0F5;--1:#4C4F69">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> event: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">GridChange</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> change</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">prepare</span><span style="--0:#C6D0F5;--1:#4C4F69">()</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">      </span></span><span style="--0:#C6D0F5;--1:#4C4F69">event</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">coord </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> [x, y]</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">      </span></span><span style="--0:#C6D0F5;--1:#4C4F69">event</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">change </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">GridChangeType</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">destroy</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">      </span></span><span style="--0:#C6D0F5;--1:#4C4F69">event</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">start </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#A6D189;--1:#2D711E">false</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">  </span></span><span style="--0:#C6D0F5;--1:#4C4F69">change</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">send</span><span style="--0:#C6D0F5;--1:#4C4F69">(data</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">entity, event)</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">set_cell</span><span style="--0:#C6D0F5;--1:#4C4F69">(data, x, y, </span><span style="--0:#EF9F76;--1:#AB4307">0</span><span style="--0:#C6D0F5;--1:#4C4F69">)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C6D0F5;--1:#4C4F69">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="destroy_block(data: Data, x: Num, y: Num) {  var event: GridChange = change.prepare()      event.coord = [x, y]      event.change = GridChangeType.destroy      event.start = false  change.send(data.entity, event)  set_cell(data, x, y, 0)}"><div></div></button></div></figure></div>
<p>And we also have to update a few places to use it.
Thereâ€™s the end of the destroy task, but thereâ€™s also some nuance.</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="wren"><code><div class="ec-line"><div class="code"><span style="--0:#CA9EE6;--1:#8035E0">if</span><span style="--0:#C6D0F5;--1:#4C4F69">(busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">done) {</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">if</span><span style="--0:#C6D0F5;--1:#4C4F69">(busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">kind </span><span style="--0:#81C8BE;--1:#116E73">==</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">DESTROY) {</span></div></div><div class="ec-line highlight del"><div class="code"><span class="indent">    </span><span style="--0:#99b4f0;--0fs:italic;--1:#1444a4;--1fs:italic">set_cell</span><span style="--0:#C6D0F5;--1:#45485f">(data, busy</span><span style="--0:#81C8BE;--1:#0d5356">.</span><span style="--0:#C6D0F5;--1:#45485f">x, busy</span><span style="--0:#81C8BE;--1:#0d5356">.</span><span style="--0:#C6D0F5;--1:#45485f">y, </span><span style="--0:#f0a27a;--1:#803205">0</span><span style="--0:#C6D0F5;--1:#45485f">)</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">    </span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">destroy_block</span><span style="--0:#C6D0F5;--1:#474a62">(data, busy</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">x, busy</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">y)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">  </span></span><span style="--0:#C6D0F5;--1:#4C4F69">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="if(busy.done) {  if(busy.kind == Busy.DESTROY) {    set_cell(data, busy.x, busy.y, 0)    destroy_block(data, busy.x, busy.y)  }"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h3"><h3 id="swap-event-start">Swap event start</h3><a class="sl-anchor-link" href="#swap-event-start"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œSwap event startâ€</span></a></div>
<p>Weâ€™ll add a few lines to our <code dir="auto">swap</code> function to send the start event.
Since â€˜startâ€™ is the default, we donâ€™t need to set it.</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">system/grid.modifier.wren...System</span></figcaption><pre data-language="wren"><code><div class="ec-line"><div class="code"><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">swap</span><span style="--0:#C6D0F5;--1:#4C4F69">(data: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Data</span><span style="--0:#C6D0F5;--1:#4C4F69">, x1: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Num</span><span style="--0:#C6D0F5;--1:#4C4F69">, y1: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Num</span><span style="--0:#C6D0F5;--1:#4C4F69">, x2: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Num</span><span style="--0:#C6D0F5;--1:#4C4F69">, y2: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Num</span><span style="--0:#C6D0F5;--1:#4C4F69">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">if</span><span style="--0:#C6D0F5;--1:#4C4F69"> (</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">!is_adjacent</span><span style="--0:#C6D0F5;--1:#4C4F69">(x1, y1, x2, y2)) </span><span style="--0:#CA9EE6;--1:#8035E0">return</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#A6D189;--1:#2D711E">false</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> busy </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">mark_busy</span><span style="--0:#C6D0F5;--1:#4C4F69">(x1, y1, </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">SWAP)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">      </span></span><span style="--0:#C6D0F5;--1:#4C4F69">busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">dest_x </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> x2</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">      </span></span><span style="--0:#C6D0F5;--1:#4C4F69">busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">dest_y </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> y2</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">      </span></span><span style="--0:#C6D0F5;--1:#4C4F69">busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">wait </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#EF9F76;--1:#AB4307">0.5</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> busy2 </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">mark_busy</span><span style="--0:#C6D0F5;--1:#4C4F69">(x2, y2, </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">SWAP)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">      </span></span><span style="--0:#C6D0F5;--1:#4C4F69">busy2</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">primary </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#A6D189;--1:#2D711E">false</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">      </span></span><span style="--0:#C6D0F5;--1:#4C4F69">busy2</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">dest_x </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> x1</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">      </span></span><span style="--0:#C6D0F5;--1:#4C4F69">busy2</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">dest_y </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> y1</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">      </span></span><span style="--0:#C6D0F5;--1:#4C4F69">busy2</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">wait </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#EF9F76;--1:#AB4307">0.5</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#cfa8e9;--1:#6429af">var</span><span style="--0:#C6D0F5;--1:#474a62"> event: </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">GridChange</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> change</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">prepare</span><span style="--0:#C6D0F5;--1:#474a62">()</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">      </span></span><span style="--0:#C6D0F5">event</span></span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">coord </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> [x1, y1]</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">      </span></span><span style="--0:#C6D0F5">event</span></span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">other </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> [x2, y2]</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">      </span></span><span style="--0:#C6D0F5">event</span></span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">change </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">GridChangeType</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">swap</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">  </span></span><span style="--0:#C6D0F5">change</span></span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">send</span><span style="--0:#C6D0F5;--1:#474a62">(data</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">entity, event)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C6D0F5;--1:#4C4F69">} </span><span style="--0:#949CBB;--0fs:italic;--1:#616373;--1fs:italic">//swap</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="swap(data: Data, x1: Num, y1: Num, x2: Num, y2: Num) {  if (!is_adjacent(x1, y1, x2, y2)) return false  var busy = mark_busy(x1, y1, Busy.SWAP)      busy.dest_x = x2      busy.dest_y = y2      busy.wait = 0.5  var busy2 = mark_busy(x2, y2, Busy.SWAP)      busy2.primary = false      busy2.dest_x = x1      busy2.dest_y = y1      busy2.wait = 0.5  var event: GridChange = change.prepare()      event.coord = [x1, y1]      event.other = [x2, y2]      event.change = GridChangeType.swap  change.send(data.entity, event)} //swap"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h3"><h3 id="swap-event-end">Swap event end</h3><a class="sl-anchor-link" href="#swap-event-end"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œSwap event endâ€</span></a></div>
<p>And the end event is inside <code dir="auto">complete_swap</code>:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">system/grid.modifier.wren...System</span></figcaption><pre data-language="wren"><code><div class="ec-line"><div class="code"><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">complete_swap</span><span style="--0:#C6D0F5;--1:#4C4F69">(data: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Data</span><span style="--0:#C6D0F5;--1:#4C4F69">, x1: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Num</span><span style="--0:#C6D0F5;--1:#4C4F69">, y1: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Num</span><span style="--0:#C6D0F5;--1:#4C4F69">, x2: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Num</span><span style="--0:#C6D0F5;--1:#4C4F69">, y2: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Num</span><span style="--0:#C6D0F5;--1:#4C4F69">) {</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> temp </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">get_cell</span><span style="--0:#C6D0F5;--1:#4C4F69">(data, x1, y1)</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">set_cell</span><span style="--0:#C6D0F5;--1:#4C4F69">(data, x1, y1, </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">get_cell</span><span style="--0:#C6D0F5;--1:#4C4F69">(data, x2, y2))</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">set_cell</span><span style="--0:#C6D0F5;--1:#4C4F69">(data, x2, y2, temp)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#cfa8e9;--1:#6429af">var</span><span style="--0:#C6D0F5;--1:#474a62"> event: </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">GridChange</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> change</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">prepare</span><span style="--0:#C6D0F5;--1:#474a62">()</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">      </span></span><span style="--0:#C6D0F5">event</span></span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">coord </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> [x1, y1]</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">      </span></span><span style="--0:#C6D0F5">event</span></span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">other </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> [x2, y2]</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">      </span></span><span style="--0:#C6D0F5">event</span></span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">change </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">GridChangeType</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">swap</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">      </span></span><span style="--0:#C6D0F5">event</span></span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">start </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#A6D189;--1:#235817">false</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">  </span></span><span style="--0:#C6D0F5">change</span></span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">send</span><span style="--0:#C6D0F5;--1:#474a62">(data</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">entity, event)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="complete_swap(data: Data, x1: Num, y1: Num, x2: Num, y2: Num) {  var temp = get_cell(data, x1, y1)  set_cell(data, x1, y1, get_cell(data, x2, y2))  set_cell(data, x2, y2, temp)  var event: GridChange = change.prepare()      event.coord = [x1, y1]      event.other = [x2, y2]      event.change = GridChangeType.swap      event.start = false  change.send(data.entity, event)"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h3"><h3 id="move-event-start">Move event start</h3><a class="sl-anchor-link" href="#move-event-start"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œMove event startâ€</span></a></div>
<p>We also need to handle the move change. Much like swap, it changes the nature of the grid, so we should make sure our visuals are synced.</p>
<p>A move is effectively a swap! So we can reuse the swap event, and let it get handled that way.
Inside <code dir="auto">drop_blocks</code> add these lines:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">system/grid.modifier.wren...System</span></figcaption><pre data-language="wren"><code><div class="ec-line"><div class="code"><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> busy </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">mark_busy</span><span style="--0:#C6D0F5;--1:#4C4F69">(x, y, </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">MOVE)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C6D0F5;--1:#4C4F69">busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">dest_y </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> write_y</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C6D0F5;--1:#4C4F69">busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">wait </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#EF9F76;--1:#AB4307">0.1</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--0:#cfa8e9;--1:#6429af">var</span><span style="--0:#C6D0F5;--1:#474a62"> event: </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">GridChange</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> change</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">prepare</span><span style="--0:#C6D0F5;--1:#474a62">()</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">  </span></span><span style="--0:#C6D0F5">event</span></span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">coord </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> [x, write_y]</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">  </span></span><span style="--0:#C6D0F5">event</span></span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">other </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> [x, y]</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">  </span></span><span style="--0:#C6D0F5">event</span></span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">change </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">GridChangeType</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">swap</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--0:#C6D0F5;--1:#474a62">change</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">send</span><span style="--0:#C6D0F5;--1:#474a62">(data</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">entity, event)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="var busy = mark_busy(x, y, Busy.MOVE)busy.dest_y = write_ybusy.wait = 0.1var event: GridChange = change.prepare()  event.coord = [x, write_y]  event.other = [x, y]  event.change = GridChangeType.swapchange.send(data.entity, event)"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h3"><h3 id="move-event-end">Move event end</h3><a class="sl-anchor-link" href="#move-event-end"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œMove event endâ€</span></a></div>
<p>And we now need to add the end event too. This is inside <code dir="auto">tick_busy</code>:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">system/grid.modifier.wren...System</span></figcaption><pre data-language="wren"><code><div class="ec-line"><div class="code"><span style="--0:#949CBB;--0fs:italic;--1:#616373;--1fs:italic">// If the task is done, handle the outcome</span></div></div><div class="ec-line"><div class="code"><span style="--0:#CA9EE6;--1:#8035E0">if</span><span style="--0:#C6D0F5;--1:#4C4F69">(busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">done) {</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">if</span><span style="--0:#C6D0F5;--1:#4C4F69">(busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">kind </span><span style="--0:#81C8BE;--1:#116E73">==</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">DESTROY) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">destroy_block</span><span style="--0:#C6D0F5;--1:#4C4F69">(data, busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">x, busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">y)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">  </span></span><span style="--0:#C6D0F5;--1:#4C4F69">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">if</span><span style="--0:#C6D0F5;--1:#4C4F69">(busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">kind </span><span style="--0:#81C8BE;--1:#116E73">==</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">MOVE) {</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">    </span><span style="--0:#cfa8e9;--1:#6429af">var</span><span style="--0:#C6D0F5;--1:#474a62"> event: </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">GridChange</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> change</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">prepare</span><span style="--0:#C6D0F5;--1:#474a62">()</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">        </span></span><span style="--0:#C6D0F5">event</span></span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">coord </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> [busy</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">x, busy</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">dest_y]</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">        </span></span><span style="--0:#C6D0F5">event</span></span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">other </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> [busy</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">x, busy</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">y]</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">        </span></span><span style="--0:#C6D0F5">event</span></span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">change </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">GridChangeType</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">swap</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">        </span></span><span style="--0:#C6D0F5">event</span></span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">start </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#A6D189;--1:#235817">false</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">    </span></span><span style="--0:#C6D0F5">change</span></span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">send</span><span style="--0:#C6D0F5;--1:#474a62">(data</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">entity, event)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> kind </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">get_cell</span><span style="--0:#C6D0F5;--1:#4C4F69">(data, busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">x, busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">y)</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">set_cell</span><span style="--0:#C6D0F5;--1:#4C4F69">(data, busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">x, busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">dest_y, </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">get_cell</span><span style="--0:#C6D0F5;--1:#4C4F69">(data, busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">x, busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">y))</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">set_cell</span><span style="--0:#C6D0F5;--1:#4C4F69">(data, busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">x, busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">y, </span><span style="--0:#EF9F76;--1:#AB4307">0</span><span style="--0:#C6D0F5;--1:#4C4F69">)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">  </span></span><span style="--0:#C6D0F5;--1:#4C4F69">}</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="// If the task is done, handle the outcomeif(busy.done) {  if(busy.kind == Busy.DESTROY) {    destroy_block(data, busy.x, busy.y)  }  if(busy.kind == Busy.MOVE) {    var event: GridChange = change.prepare()        event.coord = [busy.x, busy.dest_y]        event.other = [busy.x, busy.y]        event.change = GridChangeType.swap        event.start = false    change.send(data.entity, event)    var kind = get_cell(data, busy.x, busy.y)    set_cell(data, busy.x, busy.dest_y, get_cell(data, busy.x, busy.y))    set_cell(data, busy.x, busy.y, 0)  }"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h2"><h2 id="timing-polish">Timing polish</h2><a class="sl-anchor-link" href="#timing-polish"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œTiming polishâ€</span></a></div>
<p>Our animation is about 1 second long, in our <code dir="auto">swap</code> visuals, we set the animation rate to <code dir="auto">2</code>.
So we can change our swap timing to <code dir="auto">0.5</code> seconds to roughly match:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">system/grid.modifier.wren...System</span></figcaption><pre data-language="wren"><code><div class="ec-line"><div class="code"><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">swap</span><span style="--0:#C6D0F5;--1:#4C4F69">(data: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Data</span><span style="--0:#C6D0F5;--1:#4C4F69">, x1: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Num</span><span style="--0:#C6D0F5;--1:#4C4F69">, y1: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Num</span><span style="--0:#C6D0F5;--1:#4C4F69">, x2: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Num</span><span style="--0:#C6D0F5;--1:#4C4F69">, y2: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Num</span><span style="--0:#C6D0F5;--1:#4C4F69">) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">if</span><span style="--0:#C6D0F5;--1:#4C4F69"> (</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">!is_adjacent</span><span style="--0:#C6D0F5;--1:#4C4F69">(x1, y1, x2, y2)) </span><span style="--0:#CA9EE6;--1:#8035E0">return</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#A6D189;--1:#2D711E">false</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> busy </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">mark_busy</span><span style="--0:#C6D0F5;--1:#4C4F69">(x1, y1, </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">SWAP)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">      </span></span><span style="--0:#C6D0F5;--1:#4C4F69">busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">dest_x </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> x2</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">      </span></span><span style="--0:#C6D0F5;--1:#4C4F69">busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">dest_y </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> y2</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">      </span></span><span style="--0:#C6D0F5">busy</span></span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">wait </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#f0a57f;--1:#833305">0.5</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">var</span><span style="--0:#C6D0F5;--1:#4C4F69"> busy2 </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">mark_busy</span><span style="--0:#C6D0F5;--1:#4C4F69">(x2, y2, </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Busy</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">SWAP)</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">      </span></span><span style="--0:#C6D0F5;--1:#4C4F69">busy2</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">primary </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> </span><span style="--0:#A6D189;--1:#2D711E">false</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">      </span></span><span style="--0:#C6D0F5;--1:#4C4F69">busy2</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">dest_x </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> x1</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">      </span></span><span style="--0:#C6D0F5;--1:#4C4F69">busy2</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">dest_y </span><span style="--0:#81C8BE;--1:#116E73">=</span><span style="--0:#C6D0F5;--1:#4C4F69"> y1</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">      </span></span><span style="--0:#C6D0F5">busy2</span></span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">wait </span><span style="--0:#81C8BE;--1:#0d5458">=</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#f0a57f;--1:#833305">0.5</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="swap(data: Data, x1: Num, y1: Num, x2: Num, y2: Num) {  if (!is_adjacent(x1, y1, x2, y2)) return false  var busy = mark_busy(x1, y1, Busy.SWAP)      busy.dest_x = x2      busy.dest_y = y2      busy.wait = 0.5  var busy2 = mark_busy(x2, y2, Busy.SWAP)      busy2.primary = false      busy2.dest_x = x1      busy2.dest_y = y1      busy2.wait = 0.5"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h2"><h2 id="the-result">The result</h2><a class="sl-anchor-link" href="#the-result"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œThe resultâ€</span></a></div>
<video preload="auto" autoplay controls muted playsinline loop style="max-width:100%; width:auto; margin:auto; display:block;"> <source src="/video/tutorials/match3/grid.withshapes.mp4" type="video/mp4"> </video>
<div class="sl-heading-wrapper level-h2"><h2 id="sprites-only">Sprites only</h2><a class="sl-anchor-link" href="#sprites-only"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œSprites onlyâ€</span></a></div>
<p>Inside <code dir="auto">grid_visuals.modifier.wren</code> in the <code dir="auto">tick</code> function of our <code dir="auto">System</code>, we can turn off the <code dir="auto">Draw</code> version by commenting out that line:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">system/grid_visuals.modifier.wren...System</span></figcaption><pre data-language="wren"><code><div class="ec-line highlight ins"><div class="code"><ins><span style="--0:#bfc4d7;--0fs:italic;--1:#40414b;--1fs:italic">//</span></ins><span style="--0:#b0b6cd;--0fs:italic;--1:#4a4c58;--1fs:italic"> Draw.ngon_solid(draw, ...)</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="// Draw.ngon_solid(draw, ...)"><div></div></button></div></figure></div>
<video preload="auto" autoplay controls muted playsinline loop style="max-width:100%; width:auto; margin:auto; display:block;"> <source src="/video/tutorials/match3/grid.noshapes.mp4" type="video/mp4"> </video>
<div class="sl-heading-wrapper level-h2"><h2 id="bonus-no-randomness-random-seed">Bonus: no randomness (Random seed)</h2><a class="sl-anchor-link" href="#bonus-no-randomness-random-seed"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œBonus: no randomness (Random seed)â€</span></a></div>
<p>While testing, it can be convenient to see the same grid every time,
so you can log stuff to console and it still being valid after each change.</p>
<p>The <code dir="auto">Random.new()</code> version we use in our <code dir="auto">Grid</code> is â€œusing a default seedâ€.
That makes it random every time, but we can use a fixed seed: <code dir="auto">Random.new(3)</code>.</p>
<p>The seed is <em>the starting point</em> of the random numbers, like, a plant seed!</p>
<p>It controls what number comes next. If you specify the same seed, the same number comes next.</p>
<p>This is also typically useful in games that rely on randomness, you might save the seed and restore it for the player.</p>
<div class="sl-heading-wrapper level-h2"><h2 id="bonus-speed-control">Bonus: speed control</h2><a class="sl-anchor-link" href="#bonus-speed-control"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œBonus: speed controlâ€</span></a></div>
<p>It can be really useful to speed up or slow down time in the game to test things.
Is something going wrong? I donâ€™t know, the animation is too quick?! Slow everything down!
Need to skip some parts? Speed it up!</p>
<p>You can use this for debugging, spotting bugs and such, or for gameplay.
In our game <a href="https://anypercent.studio/mossfield-origins/">Mossfield Origins</a> the
game has a speed control, which directly sets the world rate! Very little effort if you design for it.</p>
<p>We can do that with <code dir="auto">World.set_rate</code> which controls the update rate of the world.
<code dir="auto">0</code> would be paused, <code dir="auto">1</code> would be normal speed, <code dir="auto">2</code> is twice as fast and <code dir="auto">0.5</code> is half speed.</p>
<p>In our main <code dir="auto">game.wren</code> tick function, we can add a quick debug key to try it out:</p>
<ul>
<li>press <code dir="auto">S</code> to slow down</li>
<li>press <code dir="auto">F</code> to go fast</li>
</ul>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">game.wren</span></figcaption><pre data-language="wren"><code><div class="ec-line"><div class="code"><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">tick</span><span style="--0:#C6D0F5;--1:#4C4F69">(delta: </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Num</span><span style="--0:#C6D0F5;--1:#4C4F69">) {</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#cfa8e9;--1:#6429af">if</span><span style="--0:#C6D0F5;--1:#474a62">(</span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">Input</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">key_state_released</span><span style="--0:#C6D0F5;--1:#474a62">(</span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">Key</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">key_s)) {</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">    </span><span style="--0:#cfa8e9;--1:#6429af">if</span><span style="--0:#C6D0F5;--1:#474a62">(</span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">World</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">get_rate</span><span style="--0:#C6D0F5;--1:#474a62">(world) </span><span style="--0:#81C8BE;--1:#0d5458">==</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#f0a57f;--1:#833305">1</span><span style="--0:#C6D0F5;--1:#474a62">) {</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">      </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">World</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">set_rate</span><span style="--0:#C6D0F5;--1:#474a62">(world, </span><span style="--0:#f0a57f;--1:#833305">0.1</span><span style="--0:#C6D0F5;--1:#474a62">)</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">    </span></span><span style="--0:#C6D0F5">} </span></span><span style="--0:#cfa8e9;--1:#6429af">else</span><span style="--0:#C6D0F5;--1:#474a62"> {</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">      </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">World</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">set_rate</span><span style="--0:#C6D0F5;--1:#474a62">(world, </span><span style="--0:#f0a57f;--1:#833305">1</span><span style="--0:#C6D0F5;--1:#474a62">)</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">    </span></span><span style="--0:#C6D0F5">}</span></span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">  </span></span><span style="--0:#C6D0F5">}</span></span></div></div><div class="ec-line highlight ins"><div class="code">
</div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">  </span><span style="--0:#cfa8e9;--1:#6429af">if</span><span style="--0:#C6D0F5;--1:#474a62">(</span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">Input</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">key_state_released</span><span style="--0:#C6D0F5;--1:#474a62">(</span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">Key</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#C6D0F5;--1:#474a62">key_f)) {</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">    </span><span style="--0:#cfa8e9;--1:#6429af">if</span><span style="--0:#C6D0F5;--1:#474a62">(</span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">World</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">get_rate</span><span style="--0:#C6D0F5;--1:#474a62">(world) </span><span style="--0:#81C8BE;--1:#0d5458">==</span><span style="--0:#C6D0F5;--1:#474a62"> </span><span style="--0:#f0a57f;--1:#833305">1</span><span style="--0:#C6D0F5;--1:#474a62">) {</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">      </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">World</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">set_rate</span><span style="--0:#C6D0F5;--1:#474a62">(world, </span><span style="--0:#f0a57f;--1:#833305">4</span><span style="--0:#C6D0F5;--1:#474a62">)</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">    </span></span><span style="--0:#C6D0F5">} </span></span><span style="--0:#cfa8e9;--1:#6429af">else</span><span style="--0:#C6D0F5;--1:#474a62"> {</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent">      </span><span style="--0:#E5C890;--0fs:italic;--1:#6a440e;--1fs:italic">World</span><span style="--0:#81C8BE;--1:#0d5458">.</span><span style="--0:#9cb6f0;--0fs:italic;--1:#1546a7;--1fs:italic">set_rate</span><span style="--0:#C6D0F5;--1:#474a62">(world, </span><span style="--0:#f0a57f;--1:#833305">1</span><span style="--0:#C6D0F5;--1:#474a62">)</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">    </span></span><span style="--0:#C6D0F5">}</span></span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--1:#474a62"><span class="indent"><span style="--0:#C6D0F5">  </span></span><span style="--0:#C6D0F5">}</span></span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#CA9EE6;--1:#8035E0">if</span><span style="--0:#C6D0F5;--1:#4C4F69">(</span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Input</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">key_state_released</span><span style="--0:#C6D0F5;--1:#4C4F69">(</span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">Key</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#C6D0F5;--1:#4C4F69">escape)) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#E5C890;--0fs:italic;--1:#8B5912;--1fs:italic">IO</span><span style="--0:#81C8BE;--1:#116E73">.</span><span style="--0:#8CAAEE;--0fs:italic;--1:#1B5BDA;--1fs:italic">shutdown</span><span style="--0:#C6D0F5;--1:#4C4F69">()</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#C6D0F5;--1:#4C4F69">  </span></span><span style="--0:#C6D0F5;--1:#4C4F69">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C6D0F5;--1:#4C4F69">} </span><span style="--0:#949CBB;--0fs:italic;--1:#616373;--1fs:italic">//tick</span></div></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="tick(delta: Num) {  if(Input.key_state_released(Key.key_s)) {    if(World.get_rate(world) == 1) {      World.set_rate(world, 0.1)    } else {      World.set_rate(world, 1)    }  }  if(Input.key_state_released(Key.key_f)) {    if(World.get_rate(world) == 1) {      World.set_rate(world, 4)    } else {      World.set_rate(world, 1)    }  }  if(Input.key_state_released(Key.escape)) {    IO.shutdown()  }} //tick"><div></div></button></div></figure></div>
<p>Hereâ€™s how it looks slowed down to 10% speed (<code dir="auto">S</code> key):</p>
<video preload="auto" autoplay controls muted playsinline loop style="max-width:100%; width:auto; margin:auto; display:block;"> <source src="/video/tutorials/match3/world.rate.slow.mp4" type="video/mp4"> </video>
<p>Hereâ€™s how it looks sped up to 4x speed (<code dir="auto">F</code> key):</p>
<video preload="auto" autoplay controls muted playsinline loop style="max-width:100%; width:auto; margin:auto; display:block;"> <source src="/video/tutorials/match3/world.rate.fast.mp4" type="video/mp4"> </video>
<div class="sl-heading-wrapper level-h2"><h2 id="try-this-on-your-own">Try this on your own</h2><a class="sl-anchor-link" href="#try-this-on-your-own"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled â€œTry this on your ownâ€</span></a></div>
<article class="card sl-flex astro-v5tidmuc"> <p class="title sl-flex astro-v5tidmuc"> <svg aria-hidden="true" class="icon astro-v5tidmuc astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.333em;"><path d="m17.71 11.29-5-5a1 1 0 0 0-.33-.21 1 1 0 0 0-.76 0 1 1 0 0 0-.33.21l-5 5a1 1 0 0 0 1.42 1.42L11 9.41V17a1 1 0 0 0 2 0V9.41l3.29 3.3a1 1 0 0 0 1.42 0 1 1 0 0 0 0-1.42Z"/></svg> <span class="astro-v5tidmuc">Add score</span> </p> <div class="body astro-v5tidmuc"><p>The grid emits the kind of block being destroyed by a match. Use it to implement score.
Is the score owned by the game, or by the <code dir="auto">Grid</code> system? A new system?</p></div> </article> 
<article class="card sl-flex astro-v5tidmuc"> <p class="title sl-flex astro-v5tidmuc"> <svg aria-hidden="true" class="icon astro-v5tidmuc astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.333em;"><path d="M21.71 20.29 18 16.61A9 9 0 1 0 16.61 18l3.68 3.68a.999.999 0 0 0 1.42 0 1 1 0 0 0 0-1.39ZM11 18a7 7 0 1 1 0-14 7 7 0 0 1 0 14Z"/></svg> <span class="astro-v5tidmuc">Hint</span> </p> <div class="body astro-v5tidmuc"><p>The grid system provides a way to find if there are <em>any</em> matches.
Try adapt that code to answer â€œwhere are there any matchesâ€.
Use that to highlight the first match found with <code dir="auto">Sprite</code> shine effects.</p></div> </article> 
<article class="card sl-flex astro-v5tidmuc"> <p class="title sl-flex astro-v5tidmuc"> <svg aria-hidden="true" class="icon astro-v5tidmuc astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.333em;"><path d="M12.475 21.282L12.323 21.282Q12.171 21.282 11.867 21.054L11.867 21.054L11.639 20.902Q8.067 17.824 6.167 16.266L6.167 16.266L6.053 16.190L5.939 16.152L0.923 16.152Q0.315 16.152 0.125 15.582L0.125 15.582L0.125 8.818Q0.125 8.362 0.372 8.115Q0.619 7.868 1.075 7.868L1.075 7.868L6.053 7.868Q6.281 7.868 6.281 7.716L6.281 7.716L11.753 2.966Q12.095 2.700 12.437 2.719Q12.779 2.738 13.045 3.118L13.045 3.118Q13.159 3.232 13.159 3.574L13.159 3.574L13.159 20.332Q13.159 20.978 12.703 21.168L12.703 21.168L12.589 21.168L12.475 21.282ZM23.837 12.124L23.875 12.124Q23.875 12.846 23.723 13.188L23.723 13.188Q23.571 15.354 22.659 17.482L22.659 17.482Q21.899 19.382 20.759 20.674L20.759 20.674Q20.607 20.978 20.075 21.168L20.075 21.168Q19.581 21.168 19.239 20.788L19.239 20.788Q19.049 20.636 19.049 20.389Q19.049 20.142 19.239 19.952L19.239 19.952Q19.277 19.838 19.467 19.610Q19.657 19.382 19.695 19.268L19.695 19.268Q21.481 16.760 21.823 13.910L21.823 13.910Q22.545 8.514 19.239 4.296L19.239 4.296Q18.783 3.650 19.239 3.232L19.239 3.232Q19.505 2.852 19.904 2.852Q20.303 2.852 20.645 3.232L20.645 3.232Q22.089 5.056 22.659 6.652L22.659 6.652Q23.571 8.780 23.723 11.174L23.723 11.174L23.723 12.010Q23.799 12.010 23.837 12.086L23.837 12.086L23.837 12.124ZM20.645 11.896L20.645 11.896Q20.645 15.468 18.631 18.432L18.631 18.432Q18.479 18.698 17.909 18.888L17.909 18.888Q17.453 18.888 17.073 18.546L17.073 18.546Q16.921 18.356 16.921 18.109Q16.921 17.862 17.073 17.596L17.073 17.596Q17.073 17.520 17.149 17.463Q17.225 17.406 17.187 17.368L17.187 17.368Q18.517 15.582 18.859 13.188L18.859 13.188Q19.391 9.502 17.073 6.310L17.073 6.310Q16.845 5.816 16.845 5.588L16.845 5.588Q16.959 5.284 17.073 5.132Q17.187 4.980 17.453 4.866L17.453 4.866Q18.023 4.676 18.384 5.189Q18.745 5.702 19.467 6.918L19.467 6.918Q20.531 9.236 20.531 11.060L20.531 11.060Q20.645 11.554 20.645 11.896ZM17.339 12.010L17.339 12.010Q17.339 14.366 16.123 16.038L16.123 16.038Q15.971 16.380 15.648 16.475Q15.325 16.570 14.983 16.380Q14.641 16.190 14.546 15.867Q14.451 15.544 14.717 15.202L14.717 15.202Q15.325 14.290 15.553 12.846L15.553 12.846Q15.705 11.820 15.477 10.775Q15.249 9.730 14.717 8.818L14.717 8.818Q14.527 8.438 14.603 8.115Q14.679 7.792 14.945 7.621Q15.211 7.450 15.591 7.526Q15.971 7.602 16.123 7.868L16.123 7.868Q16.655 8.666 17.073 10.110L17.073 10.110L17.149 10.414Q17.339 11.516 17.339 12.010Z"/></svg> <span class="astro-v5tidmuc">Sounds</span> </p> <div class="body astro-v5tidmuc"><p>Sounds make a big difference to polish.
Like the <a href="/getting-started/audio">Getting Started audio tutorial</a> you can get some free sounds and add audio to enhance the experience.</p></div> </article>  </div> <footer class="sl-flex astro-3yyafb3n"> <div class="meta sl-flex astro-3yyafb3n">   </div> <div class="pagination-links print:hidden astro-u2l5gyhi" dir="ltr"> <a href="/tutorials/match-3/part3/" rel="prev" class="astro-u2l5gyhi"> <svg aria-hidden="true" class="astro-u2l5gyhi astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.5rem;"><path d="M17 11H9.41l3.3-3.29a1.004 1.004 0 1 0-1.42-1.42l-5 5a1 1 0 0 0-.21.33 1 1 0 0 0 0 .76 1 1 0 0 0 .21.33l5 5a1.002 1.002 0 0 0 1.639-.325 1 1 0 0 0-.219-1.095L9.41 13H17a1 1 0 0 0 0-2Z"/></svg> <span class="astro-u2l5gyhi"> Previous <br class="astro-u2l5gyhi"> <span class="link-title astro-u2l5gyhi">Match 3 - After the prototype</span> </span> </a> <a href="/tutorials/platformer/platformer-first-steps/" rel="next" class="astro-u2l5gyhi"> <svg aria-hidden="true" class="astro-u2l5gyhi astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.5rem;"><path d="M17.92 11.62a1.001 1.001 0 0 0-.21-.33l-5-5a1.003 1.003 0 1 0-1.42 1.42l3.3 3.29H7a1 1 0 0 0 0 2h7.59l-3.3 3.29a1.002 1.002 0 0 0 .325 1.639 1 1 0 0 0 1.095-.219l5-5a1 1 0 0 0 .21-.33 1 1 0 0 0 0-.76Z"/></svg> <span class="astro-u2l5gyhi"> Next <br class="astro-u2l5gyhi"> <span class="link-title astro-u2l5gyhi">First steps</span> </span> </a> </div>   </footer>  </div> </div>   </main> </div> </div>  </div> </div>  </body></html>